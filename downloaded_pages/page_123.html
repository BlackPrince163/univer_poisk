<!DOCTYPE html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D">
<head >
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0">
  <meta name="referrer" content="unsafe-url">
  <title>Использование Postgres и JSONB для хранения товаров, характеристик и цен / Хабр</title>
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style>
  <link rel="preload" href="https://assets.habr.com/habr-web/css/theme/light.css" as="style"/><link id="light-colors" rel="stylesheet" href="https://assets.habr.com/habr-web/css/theme/light.css" media="all" />
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.5e25635d.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.13e568be.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/css/app.7eb476df.css" as="style"><link rel="preload" href="https://assets.habr.com/habr-web/js/app.757efe33.js" as="script"><link rel="preload" href="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" as="script">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.5e25635d.css"><link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.7eb476df.css">
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.8e4d9392b3879c776c445ad1bebd933d.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script>
  
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/articles\/793438\/"},"headline":"Использование Postgres и JSONB для хранения товаров, характеристик и цен","datePublished":"2024-02-13T14:53:29+03:00","dateModified":"2024-02-13T16:58:20+03:00","author":{"@type":"Person","name":"aasmc"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко...","url":"https:\/\/habr.com\/ru\/articles\/793438\/#post-content-body","about":["h_postgresql","h_java","h_kotlin","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/793438\/8fbfba2d3364876880814a61f6992823\/"]}</script>
  <style>.grecaptcha-badge{visibility: hidden;}</style>
  <meta name="habr-version" content="2.165.0">
  
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613"><meta data-vue-meta="ssr" property="fb:pages" content="472597926099084"><meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-meta="ssr" name="twitter:site" content="@habr_com"><meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name"><meta data-vue-meta="ssr" property="og:title" content="Использование Postgres и JSONB для хранения товаров, характеристик и цен" data-vmid="og:title"><meta data-vue-meta="ssr" name="twitter:title" content="Использование Postgres и JSONB для хранения товаров, характеристик и цен" data-vmid="twitter:title"><meta data-vue-meta="ssr" name="aiturec:title" content="Использование Postgres и JSONB для хранения товаров, характеристик и цен" data-vmid="aiturec:title"><meta data-vue-meta="ssr" name="description" content="Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации..." data-vmid="description"><meta data-vue-meta="ssr" itemprop="description" content="Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации..." data-vmid="description:itemprop"><meta data-vue-meta="ssr" property="og:description" content="Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации..." data-vmid="og:description"><meta data-vue-meta="ssr" name="twitter:description" content="Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации..." data-vmid="twitter:description"><meta data-vue-meta="ssr" property="aiturec:description" content="Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации..." data-vmid="aiturec:description"><meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/793438/8fbfba2d3364876880814a61f6992823/" data-vmid="image:itemprop"><meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/793438/8fbfba2d3364876880814a61f6992823/" data-vmid="og:image"><meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width"><meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height"><meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/793438/8fbfba2d3364876880814a61f6992823/" data-vmid="aiturec:image"><meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/793438/8fbfba2d3364876880814a61f6992823/" data-vmid="twitter:image"><meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/793438/8fbfba2d3364876880814a61f6992823/?format=vk" data-vmid="vk:image"><meta data-vue-meta="ssr" property="aiturec:item_id" content="793438" data-vmid="aiturec:item_id"><meta data-vue-meta="ssr" property="aiturec:datetime" content="2024-02-13T11:53:29.000Z" data-vmid="aiturec:datetime"><meta data-vue-meta="ssr" content="https://habr.com/ru/articles/793438/" property="og:url" data-vmid="og:url"><meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type"><meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale"><meta data-vue-meta="ssr" name="keywords" content="Kotlin, spring-boot, java, postgres, jsonb">
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/publications/793438/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss"><link data-vue-meta="ssr" href="https://habr.com/ru/articles/793438/" rel="canonical" data-vmid="canonical"><link data-vue-meta="ssr" rel="image_src" href="https://habr.com/share/publication/793438/8fbfba2d3364876880814a61f6992823/" data-vmid="image:href"><link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/publications/793438/">
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44">
  <meta name="msapplication-TileColor" content="#629FBC">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="16x16"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"
  >
  <link
    rel="shortcut icon"
    type="image/png"
    sizes="32x32"
    href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="76x76"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="120x120"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="152x152"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="180x180"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"
  >
  <link
    rel="apple-touch-icon"
    type="image/png"
    sizes="256x256"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"
  >
  <link
    rel="apple-touch-startup-image"
    media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"
    href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"
  >
  <link
    rel="mask-icon"
    color="#77a2b6"
    href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"
  >
  <link
    crossorigin="use-credentials"
    href="/manifest.webmanifest"
    rel="manifest"
  >
  <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script>
  <script>window.yaContextCb = window.yaContextCb || []</script>
  <script src="https://yandex.ru/ads/system/context.js" async></script>
</head>
<body>


<div id="app" data-server-rendered="true" data-async-called="true"><div class="tm-layout__wrapper"><!----> <div></div> <div class="tm-feature tm-feature"><!----></div> <header class="tm-header"><div class="tm-page-width"><div class="tm-header__container"><div class="tm-header__burger-nav"><button type="button" class="tm-header__button tm-header__button_burger"><svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon-burger"><title>Меню</title> <use xlink:href="/img/megazord-v28.faec9762..svg#header-burger"></use></svg></button></div> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo tm-header__logo_hl-ru"><svg height="16" width="16" class="tm-svg-img tm-header__icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> <!----> <div class="tm-header-user-menu tm-header_user-menu"><a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search"><title>Поиск</title> <use xlink:href="/img/megazord-v28.faec9762..svg#search"></use></svg></a> <!----> <!----> <!----> <div class="tm-header-user-menu__item"><button class="tm-header-user-menu__toggle"><svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon"><title>Настройки</title> <use xlink:href="/img/megazord-v28.faec9762..svg#page-settings"></use></svg></button></div> <a href="https://habr.com/kek/v1/auth/habrahabr/?back=/ru/articles/793438/&amp;hl=ru" rel="nofollow" class="tm-header-user-menu__item"><button type="button" class="tm-header-user-menu__login btn btn_solid btn_small">
        Войти
      </button></a> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></div></div></header> <div class="tm-layout"><div class="tm-page-progress-bar"></div> <!----> <!----> <div class="tm-page-width"></div> <main class="tm-layout__container"><div hl="ru" data-async-called="true" class="tm-page"><div class="tm-page-width"><!----> <div class="tm-page__wrapper"><div class="tm-page__main tm-page__main_has-sidebar"><div class="pull-down"><!----> <div class="pull-down__header" style="height:0px;"><div class="pull-down__content" style="bottom:10px;"><svg height="24" width="24" class="tm-svg-img pull-down__icon pull-down__arrow"><title>Обновить</title> <use xlink:href="/img/megazord-v28.faec9762..svg#pull-arrow"></use></svg></div></div> <div class="tm-adfox-banner__container"><!----> <div id="adfox_169815559787254866" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-narrow"></div></div> <div class="tm-article-presenter"> <div class="tm-article-presenter__body"><div class="tm-misprint-area"><div class="tm-misprint-area__wrapper"><article class="tm-article-presenter__content tm-article-presenter__content_narrow"><div class="tm-article-presenter__header"> <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet"> <div class="tm-article-snippet__meta-container"><div class="tm-article-snippet__meta"><span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/aasmc/" title="aasmc" class="tm-user-info__userpic"><div class="tm-entity-image"><img alt height="32" src="//habrastorage.org/r/w64/getpro/habr/avatars/093/16b/5a5/09316b5a5a9cd4cae1380b5bd0f45f7c.jpg" width="32" class="tm-entity-image__pic"></div></a> <span class="tm-user-info__user tm-user-info__user_appearance-default"><a href="/ru/users/aasmc/" class="tm-user-info__username">
      aasmc
      <!----></a> <span class="tm-article-datetime-published"><time datetime="2024-02-13T11:53:29.000Z" title="2024-02-13, 14:53">13  фев   в 14:53</time></span></span></span></div> <!----></div> <h1 lang="ru" class="tm-title tm-title_h1"><span>Использование Postgres и JSONB для хранения товаров, характеристик и цен</span></h1> <div class="tm-article-snippet__stats"><div class="tm-article-complexity tm-article-complexity_complexity-medium"><span class="tm-svg-icon__wrapper tm-article-complexity__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Уровень сложности</title> <use xlink:href="/img/megazord-v28.faec9762..svg#complexity-medium"></use></svg></span> <span class="tm-article-complexity__label">
    Средний
  </span></div> <div class="tm-article-reading-time"><span class="tm-svg-icon__wrapper tm-article-reading-time__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg></span> <span class="tm-article-reading-time__label">
    17 мин
  </span></div> <span class="tm-icon-counter tm-data-icons__item"><svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon"><title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.faec9762..svg#counter-views"></use></svg> <span class="tm-icon-counter__value">6K</span></span></div> <div class="tm-publication-hubs__container"><div class="tm-publication-hubs"><span class="tm-publication-hub__link-container"><a href="/ru/hubs/postgresql/" class="tm-publication-hub__link"><span>PostgreSQL</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/java/" class="tm-publication-hub__link"><span>Java</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-publication-hub__link-container"><a href="/ru/hubs/kotlin/" class="tm-publication-hub__link"><span>Kotlin</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span></div></div> <div class="tm-article-labels"><div class="tm-article-labels__container"><div class="tm-publication-label tm-publication-label_variant-tutorial"><span>
    Туториал
  </span></div> </div></div> <!----> <!----></div></div> <!----> <div data-gallery-root="" lang="ru" class="tm-article-body"><div></div> <div id="post-content-body"><div><div class="article-formatted-body article-formatted-body article-formatted-body_version-2"><div xmlns="http://www.w3.org/1999/xhtml"><p>Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации хранения информации о товарах, имеющих различные характеристики и цену, зависящую от характеристик. На нашем проекте применяется принцип CQRS: запись осуществляется в Postgres, чтение происходит из OpenSearch, а данные между ними перемещаются по шине, реализованной на Kafka. Такой подход обусловил использование реляционной БД для решения несвойственной ей задачи. </p><p>Чтобы увидеть, почему эта задача не нак проста, как кажется с первого взгляда, представим, что в нашем каталоге есть футболки мужские всего с двумя атрибутами: цвет  и размер. Мы хотим хранить товар с названием "Футболка Junior Developer", она представлена в синем, красном и зеленом цветах, и каждый цвет доступен в нескольких размерах. Добавляя немного сложности, представим, что цена конкретной футболки также варьируется в зависимости от цвета и размера. Как представить эту сущность в реляционной базе данных, с учетом того, что продавец футболки может в какой-то момент добавить новые атрибуты для своего товара, например, габариты упаковки для отправки<br/>(длина, ширина, высота)? </p><p>С одной стороны, можно использовать подход: <a href="https://en.wikipedia.org/wiki/Entity%E2%80%93attribute%E2%80%93value_model" rel="noopener noreferrer nofollow">Entity-Attribute-Value</a>. Он позволяет гибко настраивать связи между сущностями, их атрибутами и значениями, сохраняя возможность динамического добавления новых атрибутов сущности. Однако у такого подхода есть свои недостатки. На них останавливаться не буду - в статье: <a href="https://habr.com/ru/articles/475178/" rel="noopener noreferrer nofollow">"Замена EAV на JSONB в PostgreSQL"</a> они приведены, также там есть сравнение по производительности и памяти EAV и JSONB. </p><p>Я же постараюсь показать на конкретном примере, как можно использовать тип данных JSONB для решения этой, а также сопутствующих задач обновления и удаления атрибутов и значений с помощью функций Postgres для работы с JSONB. Как и в предыдущих постах, я подготовил небольшой <a href="https://github.com/aasmc/product-service-demo" rel="noopener noreferrer nofollow">демо проект</a>, который выложил на Github. Я не утверждаю, что данное решение является оптимальным, поэтому буду рад любой конструктивной критике. Итак, приступим.</p><h2>Модели данных</h2><h4>Product и ProductVariant. </h4><p>Общую информацию о товаре будем хранить в таблице products:</p><pre><code class="sql">CREATE TABLE products(
    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    shop_id BIGINT REFERENCES shops(id),
    category_id BIGINT REFERENCES categories(id),
    name TEXT NOT NULL,
    description TEXT NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);</code></pre><p>Детали о вариантах товара, формируемых на основе комбинаций различных атрибутов,  будем хранить в таблице product_variants:</p><pre><code class="sql">CREATE TABLE product_variants (
    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    variant_name TEXT NOT NULL,
    product_id BIGINT REFERENCES products(id) ON DELETE CASCADE,
    attribute_collection JSONB,
    image_collection JSONB,
    sku_collection JSONB,
    price DECIMAL NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);</code></pre><p>Для нас интерес представляют три поля:</p><ul><li><p>image_collection</p></li><li><p>attribute_collection</p></li><li><p>sku_collection</p></li></ul><h4>image_collection</h4><p>Каждый вариант товара может иметь одну или несколько фотографий. При этом мы храним только url на фото, и флаг, является ли это фото основным в коллекции. <code>image_collection</code> представлена следующим классом:</p><pre><code class="kotlin">data class AppImage(
    val url: String,
    val isPrimary: Boolean = false
)

data class ImageCollection(
    val images: MutableSet&lt;AppImage> = hashSetOf()
)</code></pre><h4>attribute_collection</h4><p>Это более сложный случай, который рассмотрим подробно. Атрибуты разделены на типы: строковый, числовой, цветовой и составной. Значения атрибутов также разделяются по аналогичным типам, кроме составного. В принципе, в поле JSONB можно хранить <code>Map&lt;String, Any></code>, которая и будет тем JSON объектом, приходящим с фронта при создании товара. Однако такой вариант лишает нас строгой типизации данных и чреват ошибками. Поэтому воспользуемся возможностями библиотеки Jackson по сериализации и десериализации иерархии классов, в частности аннотациями <code>@JsonTypeInfo</code> и <code>@JsonSubTypes</code>, использующимися для того, чтобы подсказать Jackson, с каким реально классом сейчас идет работа. Подробнее можно почитать <a href="https://www.baeldung.com/jackson-inheritance" rel="noopener noreferrer nofollow">тут</a>.</p><p>Итак, значения атрибутов выглядят следубщим образом:</p><pre><code class="kotlin">enum class AttributeValueType(
    @field:JsonValue
    val value: String
) {
    STRING_TYPE("string_type"),
    NUMERIC_TYPE("numeric_type"),
    COLOR_TYPE("color_type")
}

@JsonTypeInfo(
    use = JsonTypeInfo.Id.NAME,
    visible = true,
    include = JsonTypeInfo.As.EXISTING_PROPERTY,
    property = "type"
)
@JsonSubTypes(
    *arrayOf(
        JsonSubTypes.Type(
            value = StringAttributeValueDto::class,
            name = "string_type"
        ),
        JsonSubTypes.Type(
            value = NumericAttributeValueDto::class,
            name = "numeric_type"
        ),
        JsonSubTypes.Type(
            value = ColorAttributeValueDto::class,
            name = "color_type"
        )
    )
)
sealed class AttributeValueDto(
    open val type: AttributeValueType
)

data class StringAttributeValueDto(
    val stringValue: String,
    val stringRuValue: String?,
    override val type: AttributeValueType = AttributeValueType.STRING_TYPE
) : AttributeValueDto(type)

data class NumericAttributeValueDto(
    val numValue: Double,
    val numRuValue: Double?,
    val numUnit: String,
    override val type: AttributeValueType = AttributeValueType.NUMERIC_TYPE
) : AttributeValueDto(type)

data class ColorAttributeValueDto(
    val colorValue: String,
    val colorHex: String,
    override val type: AttributeValueType = AttributeValueType.COLOR_TYPE
) : AttributeValueDto(type)</code></pre><p>Сами же атрибуты представлены следующей иерархией классов, в которой ключевой момент состоит в том, чтобы обеспечить совпадение типов атрибутов и значений:</p><pre><code class="kotlin">enum class AttributeType(
    @field:JsonValue
    val value: String
) {
    STRING_ATTR("string"),
    NUMERIC_ATTR("numeric"),
    COLOR_ATTR("color"),
    COMPOSITE_ATTR("composite")
}

@JsonTypeInfo(
    use = JsonTypeInfo.Id.NAME,
    include = JsonTypeInfo.As.EXISTING_PROPERTY,
    property = "type",
    visible = true
)
@JsonSubTypes(*arrayOf(
    JsonSubTypes.Type(
        value = StringAttributeDto::class,
        name = "string"
    ),
    JsonSubTypes.Type(
        value = NumericAttributeDto::class,
        name = "numeric"
    ),
    JsonSubTypes.Type(
        value = ColorAttributeDto::class,
        name = "color"
    ),
    JsonSubTypes.Type(
        value = CompositeAttributeDto::class,
        name = "composite"
    )
))
sealed class AttributeDto(
    open val id: String?,
    open val attributeName: String,
    open val shortName: String,
    open val isFaceted: Boolean,
    open val type: AttributeType,
    open val createdAt: LocalDateTime?,
    open val isRequired: Boolean? = null,
    open val availableValues: List&lt;AttributeValueDto>
)

data class StringAttributeDto(
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val id: String? = null,
    override val attributeName: String,
    override val shortName: String,
    override val isFaceted: Boolean,
    override val type: AttributeType = AttributeType.STRING_ATTR,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val isRequired: Boolean? = null,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val createdAt: LocalDateTime? = null,
    override val availableValues: MutableList&lt;StringAttributeValueDto>,
) : AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, availableValues)

data class NumericAttributeDto(
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val id: String? = null,
    override val attributeName: String,
    override val shortName: String,
    override val isFaceted: Boolean,
    override val type: AttributeType = AttributeType.NUMERIC_ATTR,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val isRequired: Boolean? = null,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val createdAt: LocalDateTime? = null,
    override val availableValues: MutableList&lt;NumericAttributeValueDto>,
) : AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, availableValues)

data class ColorAttributeDto(
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val id: String? = null,
    override val attributeName: String,
    override val shortName: String,
    override val isFaceted: Boolean,
    override val type: AttributeType = AttributeType.COLOR_ATTR,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val isRequired: Boolean? = null,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val createdAt: LocalDateTime? = null,
    override val availableValues: MutableList&lt;ColorAttributeValueDto>,
) : AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, availableValues)

data class CompositeAttributeDto(
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val id: String? = null,
    override val attributeName: String,
    override val shortName: String,
    override val isFaceted: Boolean,
    override val type: AttributeType = AttributeType.COMPOSITE_ATTR,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val isRequired: Boolean? = null,
    @field:JsonInclude(JsonInclude.Include.NON_NULL)
    override val createdAt: LocalDateTime? = null,
    val subAttributes: List&lt;AttributeDto>
): AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, listOf())</code></pre><p>Особняком стоит составной тип атрибутов. Например, атрибут "Габариты", может содержать в себе такие под-атрибуты, как: "Длина", "Ширина" и "Высота". Сам составной атрибут не имеет непосредственного списка значений, так как все значения принадлежат конкретным под-атрибутам. </p><h4>sku_collection</h4><p>Немаловажной частью варианта товара является его артикул или <a href="https://www.shopify.com/blog/what-is-a-stock-keeping-unit" rel="noopener noreferrer nofollow">Stock Keeping Unit (SKU)</a>, который позволяет уникально идентифицировать конкретную единицу хранения товара и отслеживать ее наличие на складе. </p><p>В нашем случае, каждый вариант товара будет иметь список артикулов, представленных в следующем виде:</p><pre><code class="kotlin">data class Sku(
    val attrValue: String,
    val price: BigDecimal,
    val stock: Int,
    val sku: String
)

data class SkuCollection(
    val attrName: String,
    val skus: List&lt;Sku>
)</code></pre><p>При формировании <code>SkuCollection</code>, один из атрибутов товара будет определяющим для конкретной единицы товара (этот атрибут задается продавцом). Постараюсь пояснить. Например, у нас есть товар "Футболка Junior Developer", в нескольких вариантах, определяемых цветами, и каждый вариант имеет несколько размеров, при этом количество штук каждой футболки определенного цвета, определенного размера различается:</p><ul><li><p>синяя: XL - 2шт, XXL - 4шт</p></li><li><p>зеленая: M - 3шт, S - 1шт</p></li><li><p>красная: XS - 10шт</p></li></ul><p>Таким образом, в этом случае атрибут, определяющий конкретную единицу товара - размер, и имменно это хранится в поле <code>SkuCollection.attrName</code>. Поле <code>Sku.price</code> обеспечивает возможность хранить цену товара в зависимости от его артикула. Поле <code>Sku.stock</code> - указывает количество единиц товара на складе. Для того, чтобы не усложнять проект, сам уникальный Stock Keeping Unit - поле <code>Sku.sku</code> приходит извне, и наш сервис не отвечает за его формирование и обеспечение уникальности, читаемости и удобства использования.</p><h4>Attribute и Category</h4><p>Итак, сервис может хранить товары, их атрибуты и значения в удобном нам формате, но как бытьс тем, чтобы на фронте был удобный UI для создания товаров и заполнения информации об атрибутах? Например, мы хотим добавить новый товар "Футболка Senior Developer", для этого нам необходимо на фронте выбрать соответствующую категорию и заполнить обязательные для нее атрибуты, указать артикулы, их количество и цену. При заполнении атрибута "цвет" мы хотим, чтобы продавец не руками вводил нужный ему цвет, а выбрал из списка предложенных наиболее подходящий, и только в отсутствии такового - заполнил поле самостоятельно. Аналогично должно быть и с другими атрибутами. Для этого нам необходимо структурированно хранить данные на бэке.</p><p>Для реализации задачи используются следующие таблицы в БД. </p><pre><code class="sql">CREATE TABLE categories(
    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL UNIQUE,
    parent_id BIGINT REFERENCES categories(id),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE attributes(
    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    composite_attribute_id BIGINT REFERENCES attributes(id),
    name VARCHAR(255) NOT NULL UNIQUE,
    short_name VARCHAR(255) NOT NULL,
    is_faceted BOOLEAN NOT NULL DEFAULT true,
    is_composite BOOLEAN NOT NULL DEFAULT false,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL,
    numeric_values JSONB,
    string_values JSONB,
    color_values JSONB,
    a_type VARCHAR(8)
);

CREATE TABLE category_attributes(
    category_id BIGINT REFERENCES categories(id) NOT NULL,
    attribute_id BIGINT REFERENCES attributes(id) NOT NULL,
    is_required BOOLEAN NOT NULL DEFAULT false,
    PRIMARY KEY(category_id, attribute_id)
);</code></pre><p>Для представления данных об атрибутах в коде используется иерархия, аналогичная той, которая применяется для <code>AttributeDto</code>, однако так как в проекте используется Spring Data JPA и Hibernate в качесте persistence provider, необходимо подсказать Hibernate, какой тип наследования использовать. В нашем случае это <code>InheritanceType.SINGLE_TABLE</code> - когда данные обо всех подтипах хранятся в одной таблице, а сами подтипы различаются значением, указанным в <code>@DiscriminatorValue</code>. Плюсом такого подхода является простота реализации и скорость выборки как при полиморфных запросах, так и при запросе конкретного подтипа. Одним из минусов является невозможность наложить <code>NOT NULL</code> ограничения на уровне базы на столбцы, которые присутствуют только в подтипах. </p><p>Собственно так выглядят сами модели: </p><pre><code class="kotlin">@Entity
@Table(name = "attributes")
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "a_type")
abstract class Attribute(
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    var id: Long? = null,
    var name: String,
    @Column(name = "short_name", nullable = false)
    var shortName: String,
    @Column(name = "is_faceted", nullable = false)
    var isFaceted: Boolean,
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "composite_attribute_id")
    var compositeAttribute: CompositeAttribute? = null
) {

    @Column(name = "created_at")
    @org.hibernate.annotations.CreationTimestamp
    var createdAt: LocalDateTime? = null

    @Column(name = "updated_at")
    @org.hibernate.annotations.UpdateTimestamp
    var updatedAt: LocalDateTime? = null

    override fun equals(other: Any?): Boolean {
        val o = other as? Attribute ?: return false
        return id != null &amp;&amp; id == o.id
    }

    override fun hashCode(): Int {
        return javaClass.hashCode()
    }
}

@Entity
@DiscriminatorValue("SA")
class StringAttribute(
    name: String,
    shortName: String,
    isFaceted: Boolean,
    @org.hibernate.annotations.Type(JsonBinaryType::class)
    @Column(name = "string_values", columnDefinition = "jsonb")
    var stringValues: MutableList&lt;StringAttributeValueDto> = arrayListOf()
) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted)  {

    override fun toString(): String {
        return "StringAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)"
    }
}

@Entity
@DiscriminatorValue("NA")
class NumericAttribute(
    name: String,
    shortName: String,
    isFaceted: Boolean,
    @org.hibernate.annotations.Type(JsonBinaryType::class)
    @Column(name = "numeric_values", columnDefinition = "jsonb")
    var numericValues: MutableList&lt;NumericAttributeValueDto> = arrayListOf()
) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted) {

    override fun toString(): String {
        return "NumericAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)"
    }
}

@Entity
@DiscriminatorValue("CLA")
class ColorAttribute(
    name: String,
    shortName: String,
    isFaceted: Boolean,
    @org.hibernate.annotations.Type(JsonBinaryType::class)
    @Column(name = "color_values", columnDefinition = "jsonb")
    var colorValues: MutableList&lt;ColorAttributeValueDto> = arrayListOf()
) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted) {

    override fun toString(): String {
        return "ColorAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)"
    }
}

@Entity
@DiscriminatorValue("CA")
class CompositeAttribute(
    name: String,
    shortName: String,
    isFaceted: Boolean,
    @OneToMany(mappedBy = "compositeAttribute", cascade = [CascadeType.PERSIST])
    var subAttributes: MutableSet&lt;Attribute> = hashSetOf()
) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted) {

    override fun toString(): String {
        return "CompositeAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)"
    }
}</code></pre><p>Для того, чтобы Hibernate корректно конвертировал наш тип данных в JSONB и обратно необходимо добавить в проект зависимость на Hypersistence Utils <code>io.hypersistence:hypersistence-utils-hibernate-63:3.7.0</code> <br/>(версию необходимо кореллировать с версией Hibernate), а также указать аннотацию <code>@org.hibernate.annotations.Type(JsonBinaryType::class)</code> над требуемым полем. Более подробно о том, как мапить данные в JSONB можно почитать <a href="https://vladmihalcea.com/how-to-map-json-objects-using-generic-hibernate-types/" rel="noopener noreferrer nofollow">тут</a>.</p><p>Собственно на этом заканчивается описание модели данных, и начинается работа с <a href="https://www.postgresql.org/docs/16/functions-json.html" rel="noopener noreferrer nofollow">функциями Postgres для JSONB</a>. </p><h3>Обновление с помощью jsonb_set</h3><p>Основная логика, связанная с обновлением данных о варианте товара с помощью функции <code>jsonb_set</code> находится в репозитории: <a href="https://github.com/aasmc/product-service-demo/blob/master/src/main/kotlin/ru/aasmc/productservice/storage/repository/ProductVariantRepository.kt" rel="noopener noreferrer nofollow">ProductVariantRepository</a>. Рассмотрим подробно несколько SQL запросов. К сожалению, при использовании Spring Data JPA мы можем использовать только нативные запросы, если хотим работать с <code>jsonb_set</code>.</p><h4>Обновляем цену артикула</h4><p>Начнем с простого. Будем исходить из знания о том, что в таблице <code>product_variants</code> хранится запись о товаре со следующим списком артикулов:</p><pre><code class="json">{
    "attrName": "clothes size",
    "skus": [
      {
        "attrValue": "XS",
        "price": 10,
        "stock": 10,
        "sku": "t-shirt/blue/XS/Brand/230"
      },
      {
        "attrValue": "S",
        "price": 10,
        "stock": 10,
        "sku": "t-shirt/blue/S/Brand/231"
      },
      {
        "attrValue": "M",
        "price": 10,
        "stock": 10,
        "sku": "t-shirt/blue/M/Brand/232"
      }
    ]
  }</code></pre><p>И нам требуется изменить цену нулевого артикула с <code>sku="t-shirt/blue/XS/Brand/230"</code>. Чтобы этого добиться мы можем воспользоваться функцией <code>jsonb_set</code>. Ниже приведу полное ее описание из документации. </p><pre><code>jsonb_set ( target jsonb, path text[], new_value jsonb [, create_if_missing boolean ] ) → jsonb
Returns target with the item designated by path replaced by new_value, or with new_value added if create_if_missing is true (which is the default) and the item designated by path does not exist. All earlier steps in the path must exist, or the target is returned unchanged. As with the path oriented operators, negative integers that appear in the path count from the end of JSON arrays. If the last path step is an array index that is out of range, and create_if_missing is true, the new value is added at the beginning of the array if the index is negative, or at the end of the array if it is positive.
jsonb_set('[{"f1":1,"f2":null},2,null,3]', '{0,f1}', '[2,3,4]', false) → [{"f1": [2, 3, 4], "f2": null}, 2, null, 3]
jsonb_set('[{"f1":1,"f2":null},2]', '{0,f3}', '[2,3,4]') → [{"f1": 1, "f2": null, "f3": [2, 3, 4]}, 2]</code></pre><p>Итак, из документации становится понятно, что для того, чтобы обновить значение в JSONB, нам необходимо найти конкретный путь до поля, значение которого мы хотим поменять. В нашем случае - это <code>'{sku,0,price}'</code>, где 0 - индекс конкретного элемента <code>Sku</code> в списке. Однако при получении запроса на обновление нам не передается индекс. Для того, чтобы его найти, воспользуемся CTE и функцией <code>jsonb_array_elements</code>, раскрывающей элементы из JSON списка во множество значений. Также нам потребуется выражение <code>WITH ORDINALITY</code>, которое добавляет в выходные данные столбец типа <code>bigint</code>, числа в котором начинаются с 1 и увеличиваются на 1 для каждой строки, выданной функцией. Тут стоит учитывать, что индексы в JSONB начинаются с 0, поэтому из полученного с помощью <code>WITH ORDINALITY</code> индекса необходимо вычесть единицу. Также стоит запомнить, что <code>WITH ORDINALITY</code>возвращает <code>bigint</code>, а индексы в пути  для <code>jsonb_set</code> должны быть типа <code>int</code>, и нам в дальнейшем понадобится их кастить. Так как путь должен быть приведен к типу <code>text[]</code>, воспользуемся нативным синтаксисом Postgres. При приведении необходимо экранировать двоеточия обратным слэшем.</p><p>Так выглядит CTE:</p><pre><code class="sql">WITH sku_path AS (
    SELECT ('{skus,'||index - 1||',price}')\:\:text[] AS path
    FROM product_variants, jsonb_array_elements(sku_collection->'skus') WITH ORDINALITY arr(sku_element, index)
    WHERE id = :variantId AND sku_element->>'sku' = :sku
)</code></pre><p>Также стоит обратить внимание на специфичный для JSONB оператор <code>->></code>. Он возвращает значение в виде строки. </p><p>Осталось дело за малым - передать полученный путь в функцию <code>jsonb_set</code>. Так будет выглядеть метод для обновления цены артикула:</p><pre><code class="kotlin">@Modifying
@Query(
  value = """
          WITH sku_path AS (
              SELECT ('{skus,'||index - 1||',price}')\:\:text[] AS path
              FROM product_variants, jsonb_array_elements(sku_collection->'skus') WITH ORDINALITY arr(sku_element, index)
              WHERE id = :variantId AND sku_element->>'sku' = :sku
          )
          UPDATE product_variants
          SET sku_collection = jsonb_set(sku_collection, sku_path.path, to_jsonb(:newPrice), false)
          FROM sku_path 
          WHERE id = :variantId
       """, nativeQuery = true
)
fun updateSkuPrice(
  @Param("sku") sku: String,
  @Param("variantId") variantId: Long,
  @Param("newPrice") newPrice: BigDecimal
): Int</code></pre><h4>Добавление в конец списка</h4><p>Теперь предположим, что нам требуется добавить в конец списка в JSONB какое-то значение, например, еще одну фотографию. </p><p>Допустим, сейчас храниться только одно фото в image_collection:</p><pre><code class="json">{
  "images": [
    {"url":"http://images.com/old_blue_image.png","isPrimary":true}
  ]
}</code></pre><p>Как и в предыдущем случае воспользуемся функцией <code>jsonb_set</code>. Сейчас мы изначально знаем путь до элемента JSONB, в конец которого добавляем новый элемент, поэтому нам не понадобится CTE. Однако нам необходимо сконвертировать добавляемый в коллекцию класс <code>AppImage</code> в строку в виде JSON, так как иначе мы не сможем его скастить к типу <code>jsonb</code>. Для добавления в конец списка используется оператор <code>||</code>. Полный запрос будет выглядеть следующим образом:</p><pre><code class="kotlin">@Modifying
@Query(
  """
       UPDATE product_variants
       SET image_collection = jsonb_set(image_collection, '{images}', (image_collection->'images')\:\:jsonb || (:photo)\:\:jsonb, false)
       WHERE id = :variantId
   """, nativeQuery = true
)
fun addImage(
  @Param("variantId") variantId: Long,
  @Param("photo") photo: String
): Int</code></pre><h4>Удаление из списка</h4><p>К сожалению, нет функции, которая позволяет просто удалить значение из списка в JSONB. Однако это не безвыходная ситуация. Можем воспользоваться комбинацией функций: <code>jsonb_set</code>, <code>jsonb_array_elements</code> и <code>jsonb_agg</code>. Первые две уже знакомы, <code>jsonb_agg</code> аггрегирует передаваемые значения в JSON список. </p><p>Логика удаления такая: проходим по каждому элементу списка,  оставляем в нем только те элементы, которые не удовлетворяют условию удаления, агрегируем их обратно в список. Но тут есть важный момент: если после удаления в результирующем списке не останется элементов, то <code>jsonb_agg</code> вернет <code>NULL</code>, а нам требуется сформировать пустой список. Для этого воспользуемся функцией <code>COALESCE</code>, которая оставляет первое не <code>NULL</code> значение. Первым параметром будет результат <code>jsonb_agg</code>, а вторым - пустой список. </p><p>Сам запрос:</p><pre><code class="kotlin">@Modifying
@Query(
  """
       UPDATE product_variants
       SET image_collection = jsonb_set(
           image_collection,
           '{images}',
           COALESCE(
               (SELECT jsonb_agg(elem) 
               FROM jsonb_array_elements(image_collection->'images') elem 
               WHERE elem->>'url' != :imageUrl),
               '[]'\:\:jsonb
           )    
       )
       WHERE id = :variantId
   """, nativeQuery = true
)
fun removeImage(
  @Param("variantId") variantId: Long,
  @Param("imageUrl") imageUrl: String
): Int</code></pre><h4>Удаление из списка при двойной вложенности</h4><p>Допустим, что сейчас у товара следующий набор атрибутов:</p><pre><code class="json">{
  "attributes": [
    {
      "id": "colorAttrId",
      "attributeName": "color",
      "shortName": "color",
      "isFaceted": true,
      "type": "color",
      "isRequired": true,
      "availableValues": [
        {
          "colorValue": "red",
          "colorHex": "FF0000",
          "type": "color_type"
        }
      ]
    },
    {
      "id": "dimensId",
      "attributeName": "clothes dimensions",
      "shortName": "dimensions",
      "isFaceted": true,
      "type": "composite",
      "isRequired": false,
      "subAttributes": [
        {
          "attributeName": "width",
          "shortName": "width",
          "isFaceted": true,
          "type": "numeric",
          "availableValues": [
            {
              "numValue": 10.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            },
            {
              "numValue": 20.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            },
            {
              "numValue": 30.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            }
          ]
        },
        {
          "attributeName": "length",
          "shortName": "length",
          "isFaceted": true,
          "type": "numeric",
          "availableValues": [
            {
              "numValue": 10.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            },
            {
              "numValue": 20.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            },
            {
              "numValue": 30.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            }
          ]
        },
        {
          "attributeName": "depth",
          "shortName": "depth",
          "isFaceted": true,
          "type": "numeric",
          "availableValues": [
            {
              "numValue": 10.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            },
            {
              "numValue": 20.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            },
            {
              "numValue": 30.0,
              "numRuValue": null,
              "numUnit": "mm",
              "type": "numeric_type"
            }
          ]
        }
      ],
      "availableValues": []
    }
  ]
}</code></pre><p>И нам необходимо в атрибуте "clothes dimensions", в под-атрибуте "width" удалить значение "numValue" = 10.0. Для того, чтобы это сделать, нам придется:</p><ol><li><p>Найти индекс атрибута с названием "clothes dimensions"</p></li></ol><pre><code class="sql">WITH attr_path AS (
      SELECT CAST((index - 1) AS INTEGER) AS idx 
      FROM product_variants, jsonb_array_elements(attribute_collection->'attributes') WITH ORDINALITY arr(elem, index)
      WHERE id = :variantId AND elem->>'attributeName' = :attrName
),</code></pre><ol start="2"><li><p>Найти индекс под-атрибута с названием "width" и сформировать путь до списка <code>availableValues</code>.</p></li></ol><pre><code class="sql">sub_attr_path AS (
    SELECT('{attributes,'||(SELECT idx FROM attr_path)||',subAttributes,'||index - 1||',availableValues}')\:\:text[] as path,
    CAST((index - 1) AS INTEGER) AS idx
    FROM product_variants, jsonb_array_elements(attribute_collection->'attributes'->(SELECT idx AS INTEGER FROM attr_path)->'subAttributes') WITH ORDINALITY arr(elem, index)
    WHERE id = :variantId AND elem->>'attributeName' = :subAttrName
)</code></pre><ol start="3"><li><p>Пройти по списку "availableValues" и оставить в нем только те, элементы, которые не удовлетворяют условию удаления - то есть все, не равные 10.0.</p></li></ol><pre><code class="sql">COALESCE(
         (SELECT jsonb_agg(elem)
             FROM jsonb_array_elements(attribute_collection->'attributes'->ap.idx->'subAttributes'->sap.idx->'availableValues') elem
             WHERE CAST(elem->>'numValue' AS DOUBLE PRECISION) != :numValue 
         ),
         '[]'\:\:jsonb
     )</code></pre><p>В целом задача похожа на предыдущие, только добавляется второй уровень вложенности. Общий запрос выглядит следующим образом:</p><pre><code class="kotlin">@Modifying
@Query("""
       WITH attr_path AS (
           SELECT CAST((index - 1) AS INTEGER) AS idx 
           FROM product_variants, jsonb_array_elements(attribute_collection->'attributes') WITH ORDINALITY arr(elem, index)
           WHERE id = :variantId AND elem->>'attributeName' = :attrName
       ),
        sub_attr_path AS (
           SELECT('{attributes,'||(SELECT idx FROM attr_path)||',subAttributes,'||index - 1||',availableValues}')\:\:text[] as path,
           CAST((index - 1) AS INTEGER) AS idx
           FROM product_variants, jsonb_array_elements(attribute_collection->'attributes'->(SELECT idx AS INTEGER FROM attr_path)->'subAttributes') WITH ORDINALITY arr(elem, index)
           WHERE id = :variantId AND elem->>'attributeName' = :subAttrName
       )
       UPDATE product_variants
       SET attribute_collection = jsonb_set(
           attribute_collection,
           sap.path,
           COALESCE(
                    (SELECT jsonb_agg(elem)
                        FROM jsonb_array_elements(attribute_collection->'attributes'->ap.idx->'subAttributes'->sap.idx->'availableValues') elem
                        WHERE CAST(elem->>'numValue' AS DOUBLE PRECISION) != :numValue 
                    ),
                    '[]'\:\:jsonb
                )
       )
       FROM attr_path ap, sub_attr_path sap 
       WHERE id = :variantId
   """, nativeQuery = true)
fun removeCompositeAttributeNumericValue(
  @Param("variantId") variantId: Long,
  @Param("attrName") attrName: String,
  @Param("subAttrName") subAttrName: String,
  @Param("numValue") numValue: Double,
  ): Int</code></pre><p>Остальные запросы очень похожи на то, что разобрано выше, поэтому не составят труда для понимания. Для наглядности в проекте есть тесты как <code>ProductVariantRepository</code>, так и <code>ProductVariantController</code> - запуск тестов потребует наличия <code>Docker</code>, так как используется библиотека <code>TestContainers</code>. </p><p>Дополнительно хочу сказать, что функционал работы с JSONB в Postgres гораздо обширнее того, что рассмотрено выше: поддерживается множество других функций, <a href="https://www.postgresql.org/docs/16/functions-aggregate.html" rel="noopener noreferrer nofollow">аггрегирующие операторы</a>, можно <a href="https://postgrespro.ru/docs/postgrespro/9.5/datatype-json" rel="noopener noreferrer nofollow">создать GIN индекс</a> с классом операторов <code>jsonb_ops</code> или <code>jsonb_path_ops,</code> отличающихся по набору доступных операторов, производительности и памяти. </p><p></p></div></div></div> <!----> <!----></div> <!----> <!----></div> <!----> <div class="tm-article-presenter__meta"><div class="tm-article-presenter__meta-list tm-separated-list"><span class="tm-separated-list__title">Теги:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BKotlin%5D" class="tm-tags-list__link">Kotlin</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bspring-boot%5D" class="tm-tags-list__link">spring-boot</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bjava%5D" class="tm-tags-list__link">java</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bpostgres%5D" class="tm-tags-list__link">postgres</a></li><li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bjsonb%5D" class="tm-tags-list__link">jsonb</a></li> <!----></ul></div> <div class="tm-article-presenter__meta-list tm-separated-list"><span class="tm-separated-list__title">Хабы:</span> <ul class="tm-separated-list__list"><li class="tm-separated-list__item"><a href="/ru/hubs/postgresql/" class="tm-hubs-list__link">PostgreSQL</a></li><li class="tm-separated-list__item"><a href="/ru/hubs/java/" class="tm-hubs-list__link">Java</a></li><li class="tm-separated-list__item"><a href="/ru/hubs/kotlin/" class="tm-hubs-list__link">Kotlin</a></li> <!----></ul></div></div> <!----></article></div> <!----></div> <div class="tm-article-sticky-panel"><div class="tm-data-icons tm-article-sticky-panel__icons"><div class="tm-article-rating tm-data-icons__item"><div title="Всего голосов 11: ↑8 и ↓3" class="tm-votes-lever tm-article-rating__votes-switcher tm-votes-lever tm-votes-lever_appearance-article"><button title="Нравится" type="button" class="tm-votes-lever__button"><svg height="24" width="24" class="tm-svg-img tm-votes-lever__icon"><title>Голосование</title> <use xlink:href="/img/megazord-v28.faec9762..svg#counter-vote"></use></svg></button> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-article"><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_positive">
          +5
        </span></span></div> <button title="Не нравится" type="button" class="tm-votes-lever__button"><svg height="24" width="24" class="tm-svg-img tm-votes-lever__icon tm-votes-lever__icon_arrow-down"><title>Голосование</title> <use xlink:href="/img/megazord-v28.faec9762..svg#counter-vote"></use></svg></button></div> <DIV class="v-portal" style="display:none;"></DIV> <!----></div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.faec9762..svg#counter-favorite"></use></svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter">
    61
  </span></button> <div title="Поделиться" class="tm-sharing tm-data-icons__item"><button type="button" class="tm-sharing__button"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon"><path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path></svg></button> <DIV class="v-portal" style="display:none;"></DIV></div> <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item"><a href="/ru/articles/793438/comments/" class="tm-article-comments-counter-link__link"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.faec9762..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value">
      12
    </span></a> <!----></div> <!----> <DIV class="v-portal" style="display:none;"></DIV></div></div></div>  <div class="tm-article-presenter__footer"><div class="tm-article-blocks"><!----> <section class="tm-block tm-block tm-block_spacing-bottom"><!----> <div class="tm-block__body tm-block__body tm-block__body_variant-balanced"><div class="tm-article-author"> <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article"><div class="tm-user-card__info-container"><div class="tm-user-card__header"><div class="tm-user-card__header-data"><a href="/ru/users/aasmc/" class="tm-user-card__userpic tm-user-card__userpic_size-40"><div class="tm-entity-image"><img alt src="//habrastorage.org/getpro/habr/avatars/093/16b/5a5/09316b5a5a9cd4cae1380b5bd0f45f7c.jpg" class="tm-entity-image__pic"></div></a> <div class="tm-user-card__meta"><div title=" 7 голосов " class="tm-counter-container tm-karma tm-karma"><div class="tm-counter-container__header"><div class="tm-karma__votes tm-karma__votes_positive">
      7
    </div></div> <div class="tm-counter-container__footer"><div class="tm-karma__text">
      Карма
    </div> <DIV class="v-portal" style="display:none;"></DIV></div></div> <div title="Рейтинг пользователя" class="tm-counter-container"><div class="tm-counter-container__header"> <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating"><!----> <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating"><span><span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating">
          4
        </span></span></div> <!----></div></div> <div class="tm-counter-container__footer"><span class="tm-rating__text tm-rating__text">
      Рейтинг
    </span></div></div></div></div></div> <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article"><div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article"><!----> <a href="/ru/users/aasmc/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article">
          @aasmc
        </a> <!----></div> <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Backend разработчик на Java, Kotlin</p></div></div> <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article"><!----> <!----> <!----> <!----></div></div> <div class="tm-article-author__user-contacts"><a href="https://github.com/aasmc/" rel="noopener" target="_blank" class="tm-article-author__contact">
      Github
    </a></div></div></div> <!----></section> <div class="tm-adfox-banner__container tm-page-article__banner"><!----> <div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-leaderboard"></div></div> <div class="tm-article-blocks__comments"><div id="publication-comments" class="tm-article-page-comments"><div class="tm-article-comments-counter-link tm-article-comments-counter-button"><a href="/ru/articles/793438/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style"><svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted"><title>Комментарии</title> <use xlink:href="/img/megazord-v28.faec9762..svg#counter-comments"></use></svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted">
       Комментарии 12 
    </span></a> <!----></div></div></div>  <section class="tm-block tm-block tm-block_spacing-bottom"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim"><div class="tm-tabs tm-tabs"><div><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim">
        Лучшие за сутки
      </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim">
        Похожие
      </button></span></div> <!----></div> <div class="similar-and-daily__tab-view"><div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-article-cards"><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div><div class="tm-placeholder-article-card"><div class="tm-placeholder__user"><div class="tm-placeholder__user-pic loads"></div> <div class="tm-placeholder__user-date loads"></div></div> <div class="tm-placeholder-article-card__title"><div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div></div> <div class="tm-placeholder-article-card__icons tm-placeholder__counters"><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div><div class="tm-placeholder-data-icon"><div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div></div></div></div></div> <!----> <!----> <!----> <!----> <!----></div> <!----></div></div> <!----></section> <section data-navigatable="" tabindex="0" data-async-called="true" class="tm-block tm-stories-block tm-block tm-block_spacing-around"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Истории</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-equal"><div class="tm-stories-empty"><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div><div class="tm-stories-card-empty"><div class="tm-stories-card-empty__image"></div> <div class="tm-stories-card-empty__title"><div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div> <div class="tm-stories-card-empty__title-block"></div></div></div></div> <!----></div> <!----></section> <div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-inset tm-placeholder-vacancies"><div class="tm-placeholder-inset__header"><div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div></div> <div class="tm-placeholder-inset__body"><ul class="tm-placeholder-list"><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li><li class="tm-placeholder-list__item tm-placeholder-list__item_inset"><div class="tm-placeholder-list__title-container"><div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div></div> <div class="tm-project-block-items__properties"><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span></div></li></ul></div> <div class="tm-placeholder-inset__footer"><div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div></div></div> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----></div> <!----> <div><div class="placeholder-wrapper"><!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <div class="tm-placeholder-promo"><div class="tm-placeholder-promo__header"><div class="tm-placeholder__line tm-placeholder__line_promo-title"></div></div> <div class="tm-placeholder-promo__body"><div class="tm-placeholder-promo__posts"><div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div> <div class="tm-placeholder-promo__post"><div class="tm-placeholder-promo__image"></div> <div class="tm-placeholder__line tm-placeholder__line_post-title"></div></div></div> <div class="tm-placeholder-promo__dots"><div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div> <div class="tm-placeholder-promo__dot"></div></div></div></div> <!----> <!----> <!----> <!----> <!----> <!----></div></div> <section data-async-called="true" class="tm-block tm-block tm-block_spacing-top"><header class="tm-block__header tm-block__header"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Работа</h2> </div> <!----></header> <div class="tm-block__body tm-block__body"><div class="tm-vacancies-block__item"><a href="https://career.habr.com/vacancies/java_developer" target="_blank" class="tm-vacancies-block__vacancy-title">
        Java разработчик
      </a> <div class="tm-vacancies-block__vacancies-count">
        411
    вакансий
      </div></div></div> <footer class="tm-block__footer"><a href="https://career.habr.com/catalog" class="tm-block-extralink">
      Все вакансии
    </a></footer></section> <section data-navigatable="" tabindex="0" data-async-called="true" class="tm-block tm-events-block tm-block tm-block_spacing-around"><header class="tm-block__header tm-block__header tm-block__header_variant-borderless"><div class="tm-block__header-container"><h2 class="tm-block__title tm-block__title">Ближайшие события</h2> </div> <!----></header> <div class="tm-block__body tm-block__body tm-block__body_variant-equal"><div class="swiper-container tm-events-widget" style="--swiper-space-between:22px;"><div class="swiper-wrapper"><div class="swiper-slide"><section id="events_130" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/48c/817/f0b/48c817f0b52e6b603845a694cb2cd251.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/48c/817/f0b/48c817f0b52e6b603845a694cb2cd251.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/48c/817/f0b/48c817f0b52e6b603845a694cb2cd251.png, https://habrastorage.org/getpro/habr/upload_files/48c/817/f0b/48c817f0b52e6b603845a694cb2cd251.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_130" class="tm-event-card__title-link">Как использовать облачные платформы Сloud.ru: серия демо-встреч по четвергам</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>1 – 29  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>11:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_130" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_154" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/79a/ee8/11d/79aee811d3b1883b61032cc3a14949d7.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/79a/ee8/11d/79aee811d3b1883b61032cc3a14949d7.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/79a/ee8/11d/79aee811d3b1883b61032cc3a14949d7.png, https://habrastorage.org/getpro/habr/upload_files/79a/ee8/11d/79aee811d3b1883b61032cc3a14949d7.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_154" class="tm-event-card__title-link">Конкурс грантов на обучение IT-профессиям от Хекслета</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>5 – 29  февраля  </span></div> <!----></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_154" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_138" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/f53/f54/b2f/f53f54b2f7678f06644c36b44ff870cd.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/f53/f54/b2f/f53f54b2f7678f06644c36b44ff870cd.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/f53/f54/b2f/f53f54b2f7678f06644c36b44ff870cd.png, https://habrastorage.org/getpro/habr/upload_files/f53/f54/b2f/f53f54b2f7678f06644c36b44ff870cd.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_138" class="tm-event-card__title-link">Неделя победителей рейтинга Хабр Карьеры</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>12 – 18  февраля  </span></div> <!----></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_138" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_132" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/849/5ba/6c0/8495ba6c0395a49ca999ba71073fa605.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/849/5ba/6c0/8495ba6c0395a49ca999ba71073fa605.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/849/5ba/6c0/8495ba6c0395a49ca999ba71073fa605.png, https://habrastorage.org/getpro/habr/upload_files/849/5ba/6c0/8495ba6c0395a49ca999ba71073fa605.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_132" class="tm-event-card__title-link">Открытый урок «Тимлид с технической ролью и без неё»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>13  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_132" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_136" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/4ab/bff/fd2/4abbfffd208d3b4d5cd61c402d7ec3de.jpg" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/4ab/bff/fd2/4abbfffd208d3b4d5cd61c402d7ec3de.jpg" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/4ab/bff/fd2/4abbfffd208d3b4d5cd61c402d7ec3de.jpg, https://habrastorage.org/getpro/habr/upload_files/4ab/bff/fd2/4abbfffd208d3b4d5cd61c402d7ec3de.jpg 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_136" class="tm-event-card__title-link">Вебинар «Архитектура решений на основе Kubernetes»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>13  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_136" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_144" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/6f0/5ed/6c3/6f05ed6c3d7ec44efc35aa16efafc859.jpg" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/6f0/5ed/6c3/6f05ed6c3d7ec44efc35aa16efafc859.jpg" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/6f0/5ed/6c3/6f05ed6c3d7ec44efc35aa16efafc859.jpg, https://habrastorage.org/getpro/habr/upload_files/6f0/5ed/6c3/6f05ed6c3d7ec44efc35aa16efafc859.jpg 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_144" class="tm-event-card__title-link">Открытый урок «Vault PKI. Строим собственный Certificate Authority»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>13  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_144" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_146" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/aa4/e0e/f99/aa4e0ef990e286dc3cec513c7a7f2e58.jpg" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/aa4/e0e/f99/aa4e0ef990e286dc3cec513c7a7f2e58.jpg" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/aa4/e0e/f99/aa4e0ef990e286dc3cec513c7a7f2e58.jpg, https://habrastorage.org/getpro/habr/upload_files/aa4/e0e/f99/aa4e0ef990e286dc3cec513c7a7f2e58.jpg 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_146" class="tm-event-card__title-link">Открытый урок «Пишем музыкальный виджет на SwiftUI»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>15  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_146" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_158" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/2ff/e12/876/2ffe128762377eae3980a5eab3e4f99d.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/2ff/e12/876/2ffe128762377eae3980a5eab3e4f99d.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/2ff/e12/876/2ffe128762377eae3980a5eab3e4f99d.png, https://habrastorage.org/getpro/habr/upload_files/2ff/e12/876/2ffe128762377eae3980a5eab3e4f99d.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_158" class="tm-event-card__title-link">Практический урок «Почему не отслеживать метрики в IT-компании — плохая идея?»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>15  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_158" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_162" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/6d4/136/22c/6d413622ccff3c25ae26659f337e7dca.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/6d4/136/22c/6d413622ccff3c25ae26659f337e7dca.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/6d4/136/22c/6d413622ccff3c25ae26659f337e7dca.png, https://habrastorage.org/getpro/habr/upload_files/6d4/136/22c/6d413622ccff3c25ae26659f337e7dca.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_162" class="tm-event-card__title-link">One Day Offer от УЦСБ</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>17  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>10:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_162" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_142" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/d1e/a22/4cd/d1ea224cd82ae67817b7cac7f7fc052c.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/d1e/a22/4cd/d1ea224cd82ae67817b7cac7f7fc052c.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/d1e/a22/4cd/d1ea224cd82ae67817b7cac7f7fc052c.png, https://habrastorage.org/getpro/habr/upload_files/d1e/a22/4cd/d1ea224cd82ae67817b7cac7f7fc052c.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_142" class="tm-event-card__title-link">Первая всероссийская студенческая олимпиада по фронтенду</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>18 – 19  февраля  </span></div> <!----></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_142" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_156" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/ed3/70c/212/ed370c212aac499c0289e66545c1c82e.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/ed3/70c/212/ed370c212aac499c0289e66545c1c82e.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/ed3/70c/212/ed370c212aac499c0289e66545c1c82e.png, https://habrastorage.org/getpro/habr/upload_files/ed3/70c/212/ed370c212aac499c0289e66545c1c82e.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_156" class="tm-event-card__title-link">Практический урок «Hard Skills корпоративного архитектора»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>19  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>19:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_156" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_164" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/c75/441/935/c7544193515536c86f9e6dce2908340b.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/c75/441/935/c7544193515536c86f9e6dce2908340b.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/c75/441/935/c7544193515536c86f9e6dce2908340b.png, https://habrastorage.org/getpro/habr/upload_files/c75/441/935/c7544193515536c86f9e6dce2908340b.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_164" class="tm-event-card__title-link">Открытый урок «Stand Up "Team Lead". Открытый микрофон. 5 спикеров курса»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>19  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_164" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_170" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/a9b/40b/bbb/a9b40bbbbd5a1f307dcc513f764bbecc.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/a9b/40b/bbb/a9b40bbbbd5a1f307dcc513f764bbecc.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/a9b/40b/bbb/a9b40bbbbd5a1f307dcc513f764bbecc.png, https://habrastorage.org/getpro/habr/upload_files/a9b/40b/bbb/a9b40bbbbd5a1f307dcc513f764bbecc.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_170" class="tm-event-card__title-link">Вебинар «Разрабатываем pipeline в ClearML и удаленный запуск на сервер»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>21  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_170" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_122" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/d6e/1b0/4c8/d6e1b04c878148e37a547e03a37c18ee.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/d6e/1b0/4c8/d6e1b04c878148e37a547e03a37c18ee.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/d6e/1b0/4c8/d6e1b04c878148e37a547e03a37c18ee.png, https://habrastorage.org/getpro/habr/upload_files/d6e/1b0/4c8/d6e1b04c878148e37a547e03a37c18ee.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_122" class="tm-event-card__title-link">Вебинар «Лихие джуновские: что нужно знать про найм в ML/DS в начале карьеры»</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>27  февраля  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_122" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_140" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/2a5/b6d/6fc/2a5b6d6fc13caf3dabce9c8ab833e282.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/2a5/b6d/6fc/2a5b6d6fc13caf3dabce9c8ab833e282.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/2a5/b6d/6fc/2a5b6d6fc13caf3dabce9c8ab833e282.png, https://habrastorage.org/getpro/habr/upload_files/2a5/b6d/6fc/2a5b6d6fc13caf3dabce9c8ab833e282.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_140" class="tm-event-card__title-link">DevOpsConf 2024: конференция для инженеров и всех, кто должен понимать инженеров</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>4 – 5  марта  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>10:00 – 20:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Москва</span> <span class="tm-event-card__places-separator"> • </span></span><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_140" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div><div class="swiper-slide"><section id="events_160" tabindex="-1" class="tm-block tm-block tm-block_spacing-none"><!----> <div class="tm-event-card tm-event-card_is-widget tm-event-card_responsive"><img alt="" data-src="https://habrastorage.org/getpro/habr/upload_files/9e2/1fc/f5c/9e21fcf5cb7e9bae5b0f7cb2fafd6a99.png" loading="lazy" src="https://habrastorage.org/r/w390/getpro/habr/upload_files/9e2/1fc/f5c/9e21fcf5cb7e9bae5b0f7cb2fafd6a99.png" srcset="https://habrastorage.org/r/w390/getpro/habr/upload_files/9e2/1fc/f5c/9e21fcf5cb7e9bae5b0f7cb2fafd6a99.png, https://habrastorage.org/getpro/habr/upload_files/9e2/1fc/f5c/9e21fcf5cb7e9bae5b0f7cb2fafd6a99.png 2x" class="tm-event-card__image"> <!----> <div class="tm-event-card__info"><a href="/ru/events/#events_160" class="tm-event-card__title-link">«GoCloud 2024. Облачные грани будущего» — IT-конференция Cloud.ru про облака</a> <div class="tm-event-card__date"><div class="tm-event-card__day"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Дата</title> <use xlink:href="/img/megazord-v28.faec9762..svg#calendar"></use></svg> <span>21  марта  </span></div> <div class="tm-event-card__time"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon"><title>Время</title> <use xlink:href="/img/megazord-v28.faec9762..svg#clock"></use></svg> <span>09:00 – 18:00</span></div></div> <div class="tm-event-card__places"><svg height="24" width="24" class="tm-svg-img tm-event-card__icon tm-event-card__icon_place"><title>Место</title> <use xlink:href="/img/megazord-v28.faec9762..svg#geo"></use></svg> <div class="tm-event-card__places-list"><span class="tm-event-card__places-item"><span>Москва</span> <span class="tm-event-card__places-separator"> • </span></span><span class="tm-event-card__places-item"><span>Онлайн</span> <!----></span></div></div> <div class="tm-event-card__footer"><a href="/ru/events/#events_160" class="tm-event-card__link">
            Подробнее в календаре
          </a></div></div> <!----></div> <!----></section></div></div> <!----> <button class="swiper-button-prev"><span class="tm-svg-icon__wrapper swiper-button-icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Влево</title> <use xlink:href="/img/megazord-v28.faec9762..svg#arrow-back"></use></svg></span></button> <button class="swiper-button-next"><span class="tm-svg-icon__wrapper swiper-button-icon"><svg height="24" width="24" class="tm-svg-img tm-svg-icon"><title>Вправо</title> <use xlink:href="/img/megazord-v28.faec9762..svg#arrow-back"></use></svg></span></button></div></div> <!----></section></div></div></div></div></div> <div class="tm-page__sidebar"><!----></div></div></div></div></main> <!----></div> <!----> <div class="tm-footer"><div class="tm-page-width"><div class="tm-footer__container"><div class="tm-footer__title"><a href="/ru/" class="tm-svg-icon__wrapper tm-footer__title-link"><svg height="16" width="16" class="tm-svg-img tm-svg-icon"><title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use></svg></a></div> <div class="tm-footer__social"><a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="36" width="36" class="tm-svg-img tm-svg-icon"><title>Facebook</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-facebook"></use></svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="36" width="36" class="tm-svg-img tm-svg-icon"><title>Twitter</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-twitter"></use></svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="36" width="36" class="tm-svg-img tm-svg-icon"><title>VK</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-vk"></use></svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="36" width="36" class="tm-svg-img tm-svg-icon"><title>Telegram</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-telegram"></use></svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="36" width="36" class="tm-svg-img tm-svg-icon"><title>Youtube</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-youtube"></use></svg></a><a href="https://dzen.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon"><svg height="36" width="36" class="tm-svg-img tm-svg-icon"><title>Яндекс Дзен</title> <use xlink:href="/img/new-social-icons-sprite.svg#social-logo-dzen"></use></svg></a></div> <DIV class="v-portal" style="display:none;"></DIV> <button class="tm-footer__link"><svg height="16" width="16" class="tm-svg-img tm-footer__icon"><title>Язык</title> <use xlink:href="/img/megazord-v28.faec9762..svg#lang"></use></svg>
        Настройка языка
      </button> <a href="/ru/feedback/" class="tm-footer__link">
        Техническая поддержка
      </a> <div class="tm-footer-copyright"><span class="tm-copyright"><span class="tm-copyright__years">© 2006–2024, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span></div></div></div></div> <!----></div> <div class="vue-portal-target"></div></div>
<script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"793438":{"id":"793438","timePublished":"2024-02-13T11:53:29+00:00","isCorporative":false,"lang":"ru","titleHtml":"Использование Postgres и JSONB для хранения товаров, характеристик и цен","leadData":{"textHtml":"\u003Cp\u003EВсем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации хранения информации о товарах, имеющих различные характеристики и цену, зависящую от характеристик. На нашем проекте применяется принцип CQRS: запись осуществляется в Postgres, чтение происходит из OpenSearch, а данные между ними перемещаются по шине, реализованной на Kafka. Такой подход обусловил использование реляционной БД для решения несвойственной ей задачи. \u003C\u002Fp\u003E\u003Cp\u003EЧтобы увидеть, почему эта задача не нак проста, как кажется с первого взгляда, представим, что в нашем каталоге есть футболки мужские всего с двумя атрибутами: цвет и размер. Мы хотим хранить товар с названием \"Футболка Junior Developer\", она представлена в синем, красном и зеленом цветах, и каждый цвет доступен в нескольких размерах. Добавляя немного сложности, представим, что цена конкретной футболки также варьируется в зависимости от цвета и размера. Как представить эту сущность в реляционной базе данных, с учетом того, что продавец футболки может в какой-то момент добавить новые атрибуты для своего товара, например, габариты упаковки для отправки (длина, ширина, высота)? \u003C\u002Fp\u003E\u003Cp\u003EС одной стороны, можно использовать подход: \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FEntity%E2%80%93attribute%E2%80%93value_model\" rel=\"noopener noreferrer nofollow\"\u003EEntity-Attribute-Value\u003C\u002Fa\u003E. Он позволяет гибко настраивать связи между сущностями, их атрибутами и значениями, сохраняя возможность динамического добавления новых атрибутов сущности. Однако у такого подхода есть свои недостатки. На них останавливаться не буду - в статье: \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F475178\u002F\" rel=\"noopener noreferrer nofollow\"\u003E\"Замена EAV на JSONB в PostgreSQL\"\u003C\u002Fa\u003E они приведены, также там есть сравнение по производительности и памяти EAV и JSONB. \u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать далее","image":null},"editorVersion":"2.0","postType":"article","postLabels":[],"author":{"id":"3886778","alias":"aasmc","fullname":null,"avatarUrl":"\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Favatars\u002F093\u002F16b\u002F5a5\u002F09316b5a5a9cd4cae1380b5bd0f45f7c.jpg","speciality":"Backend разработчик на Java, Kotlin","scoreStats":{"score":7,"votesCount":7},"rating":4,"relatedData":null,"contacts":[{"title":"Github","url":"https:\u002F\u002Fgithub.com\u002Faasmc\u002F","value":"aasmc","siteTitle":null,"favicon":null}],"authorContacts":[{"title":"Github","url":"https:\u002F\u002Fgithub.com\u002Faasmc\u002F","value":"aasmc","siteTitle":null,"favicon":null}],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null},"donationsMethod":null},"statistics":{"commentsCount":12,"favoritesCount":61,"readingCount":5965,"score":5,"votesCount":11,"votesCountPlus":8,"votesCountMinus":3},"hubs":[{"id":"358","alias":"postgresql","type":"collective","title":"PostgreSQL","titleHtml":"PostgreSQL","isProfiled":true,"relatedData":null},{"id":"375","alias":"java","type":"collective","title":"Java","titleHtml":"Java","isProfiled":true,"relatedData":null},{"id":"19441","alias":"kotlin","type":"collective","title":"Kotlin","titleHtml":"Kotlin","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EВсем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации хранения информации о товарах, имеющих различные характеристики и цену, зависящую от характеристик. На нашем проекте применяется принцип CQRS: запись осуществляется в Postgres, чтение происходит из OpenSearch, а данные между ними перемещаются по шине, реализованной на Kafka. Такой подход обусловил использование реляционной БД для решения несвойственной ей задачи. \u003C\u002Fp\u003E\u003Cp\u003EЧтобы увидеть, почему эта задача не нак проста, как кажется с первого взгляда, представим, что в нашем каталоге есть футболки мужские всего с двумя атрибутами: цвет  и размер. Мы хотим хранить товар с названием \"Футболка Junior Developer\", она представлена в синем, красном и зеленом цветах, и каждый цвет доступен в нескольких размерах. Добавляя немного сложности, представим, что цена конкретной футболки также варьируется в зависимости от цвета и размера. Как представить эту сущность в реляционной базе данных, с учетом того, что продавец футболки может в какой-то момент добавить новые атрибуты для своего товара, например, габариты упаковки для отправки\u003Cbr\u002F\u003E(длина, ширина, высота)? \u003C\u002Fp\u003E\u003Cp\u003EС одной стороны, можно использовать подход: \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FEntity%E2%80%93attribute%E2%80%93value_model\" rel=\"noopener noreferrer nofollow\"\u003EEntity-Attribute-Value\u003C\u002Fa\u003E. Он позволяет гибко настраивать связи между сущностями, их атрибутами и значениями, сохраняя возможность динамического добавления новых атрибутов сущности. Однако у такого подхода есть свои недостатки. На них останавливаться не буду - в статье: \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F475178\u002F\" rel=\"noopener noreferrer nofollow\"\u003E\"Замена EAV на JSONB в PostgreSQL\"\u003C\u002Fa\u003E они приведены, также там есть сравнение по производительности и памяти EAV и JSONB. \u003C\u002Fp\u003E\u003Cp\u003EЯ же постараюсь показать на конкретном примере, как можно использовать тип данных JSONB для решения этой, а также сопутствующих задач обновления и удаления атрибутов и значений с помощью функций Postgres для работы с JSONB. Как и в предыдущих постах, я подготовил небольшой \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Faasmc\u002Fproduct-service-demo\" rel=\"noopener noreferrer nofollow\"\u003Eдемо проект\u003C\u002Fa\u003E, который выложил на Github. Я не утверждаю, что данное решение является оптимальным, поэтому буду рад любой конструктивной критике. Итак, приступим.\u003C\u002Fp\u003E\u003Ch2\u003EМодели данных\u003C\u002Fh2\u003E\u003Ch4\u003EProduct и ProductVariant. \u003C\u002Fh4\u003E\u003Cp\u003EОбщую информацию о товаре будем хранить в таблице products:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003ECREATE TABLE products(\n    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,\n    shop_id BIGINT REFERENCES shops(id),\n    category_id BIGINT REFERENCES categories(id),\n    name TEXT NOT NULL,\n    description TEXT NOT NULL,\n    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДетали о вариантах товара, формируемых на основе комбинаций различных атрибутов,  будем хранить в таблице product_variants:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003ECREATE TABLE product_variants (\n    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,\n    variant_name TEXT NOT NULL,\n    product_id BIGINT REFERENCES products(id) ON DELETE CASCADE,\n    attribute_collection JSONB,\n    image_collection JSONB,\n    sku_collection JSONB,\n    price DECIMAL NOT NULL,\n    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДля нас интерес представляют три поля:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eimage_collection\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eattribute_collection\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Esku_collection\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch4\u003Eimage_collection\u003C\u002Fh4\u003E\u003Cp\u003EКаждый вариант товара может иметь одну или несколько фотографий. При этом мы храним только url на фото, и флаг, является ли это фото основным в коллекции. \u003Ccode\u003Eimage_collection\u003C\u002Fcode\u003E представлена следующим классом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Edata class AppImage(\n    val url: String,\n    val isPrimary: Boolean = false\n)\n\ndata class ImageCollection(\n    val images: MutableSet&lt;AppImage\u003E = hashSetOf()\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4\u003Eattribute_collection\u003C\u002Fh4\u003E\u003Cp\u003EЭто более сложный случай, который рассмотрим подробно. Атрибуты разделены на типы: строковый, числовой, цветовой и составной. Значения атрибутов также разделяются по аналогичным типам, кроме составного. В принципе, в поле JSONB можно хранить \u003Ccode\u003EMap&lt;String, Any\u003E\u003C\u002Fcode\u003E, которая и будет тем JSON объектом, приходящим с фронта при создании товара. Однако такой вариант лишает нас строгой типизации данных и чреват ошибками. Поэтому воспользуемся возможностями библиотеки Jackson по сериализации и десериализации иерархии классов, в частности аннотациями \u003Ccode\u003E@JsonTypeInfo\u003C\u002Fcode\u003E и \u003Ccode\u003E@JsonSubTypes\u003C\u002Fcode\u003E, использующимися для того, чтобы подсказать Jackson, с каким реально классом сейчас идет работа. Подробнее можно почитать \u003Ca href=\"https:\u002F\u002Fwww.baeldung.com\u002Fjackson-inheritance\" rel=\"noopener noreferrer nofollow\"\u003Eтут\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EИтак, значения атрибутов выглядят следубщим образом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Eenum class AttributeValueType(\n    @field:JsonValue\n    val value: String\n) {\n    STRING_TYPE(\"string_type\"),\n    NUMERIC_TYPE(\"numeric_type\"),\n    COLOR_TYPE(\"color_type\")\n}\n\n@JsonTypeInfo(\n    use = JsonTypeInfo.Id.NAME,\n    visible = true,\n    include = JsonTypeInfo.As.EXISTING_PROPERTY,\n    property = \"type\"\n)\n@JsonSubTypes(\n    *arrayOf(\n        JsonSubTypes.Type(\n            value = StringAttributeValueDto::class,\n            name = \"string_type\"\n        ),\n        JsonSubTypes.Type(\n            value = NumericAttributeValueDto::class,\n            name = \"numeric_type\"\n        ),\n        JsonSubTypes.Type(\n            value = ColorAttributeValueDto::class,\n            name = \"color_type\"\n        )\n    )\n)\nsealed class AttributeValueDto(\n    open val type: AttributeValueType\n)\n\ndata class StringAttributeValueDto(\n    val stringValue: String,\n    val stringRuValue: String?,\n    override val type: AttributeValueType = AttributeValueType.STRING_TYPE\n) : AttributeValueDto(type)\n\ndata class NumericAttributeValueDto(\n    val numValue: Double,\n    val numRuValue: Double?,\n    val numUnit: String,\n    override val type: AttributeValueType = AttributeValueType.NUMERIC_TYPE\n) : AttributeValueDto(type)\n\ndata class ColorAttributeValueDto(\n    val colorValue: String,\n    val colorHex: String,\n    override val type: AttributeValueType = AttributeValueType.COLOR_TYPE\n) : AttributeValueDto(type)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСами же атрибуты представлены следующей иерархией классов, в которой ключевой момент состоит в том, чтобы обеспечить совпадение типов атрибутов и значений:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Eenum class AttributeType(\n    @field:JsonValue\n    val value: String\n) {\n    STRING_ATTR(\"string\"),\n    NUMERIC_ATTR(\"numeric\"),\n    COLOR_ATTR(\"color\"),\n    COMPOSITE_ATTR(\"composite\")\n}\n\n@JsonTypeInfo(\n    use = JsonTypeInfo.Id.NAME,\n    include = JsonTypeInfo.As.EXISTING_PROPERTY,\n    property = \"type\",\n    visible = true\n)\n@JsonSubTypes(*arrayOf(\n    JsonSubTypes.Type(\n        value = StringAttributeDto::class,\n        name = \"string\"\n    ),\n    JsonSubTypes.Type(\n        value = NumericAttributeDto::class,\n        name = \"numeric\"\n    ),\n    JsonSubTypes.Type(\n        value = ColorAttributeDto::class,\n        name = \"color\"\n    ),\n    JsonSubTypes.Type(\n        value = CompositeAttributeDto::class,\n        name = \"composite\"\n    )\n))\nsealed class AttributeDto(\n    open val id: String?,\n    open val attributeName: String,\n    open val shortName: String,\n    open val isFaceted: Boolean,\n    open val type: AttributeType,\n    open val createdAt: LocalDateTime?,\n    open val isRequired: Boolean? = null,\n    open val availableValues: List&lt;AttributeValueDto\u003E\n)\n\ndata class StringAttributeDto(\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val id: String? = null,\n    override val attributeName: String,\n    override val shortName: String,\n    override val isFaceted: Boolean,\n    override val type: AttributeType = AttributeType.STRING_ATTR,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val isRequired: Boolean? = null,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val createdAt: LocalDateTime? = null,\n    override val availableValues: MutableList&lt;StringAttributeValueDto\u003E,\n) : AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, availableValues)\n\ndata class NumericAttributeDto(\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val id: String? = null,\n    override val attributeName: String,\n    override val shortName: String,\n    override val isFaceted: Boolean,\n    override val type: AttributeType = AttributeType.NUMERIC_ATTR,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val isRequired: Boolean? = null,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val createdAt: LocalDateTime? = null,\n    override val availableValues: MutableList&lt;NumericAttributeValueDto\u003E,\n) : AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, availableValues)\n\ndata class ColorAttributeDto(\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val id: String? = null,\n    override val attributeName: String,\n    override val shortName: String,\n    override val isFaceted: Boolean,\n    override val type: AttributeType = AttributeType.COLOR_ATTR,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val isRequired: Boolean? = null,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val createdAt: LocalDateTime? = null,\n    override val availableValues: MutableList&lt;ColorAttributeValueDto\u003E,\n) : AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, availableValues)\n\ndata class CompositeAttributeDto(\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val id: String? = null,\n    override val attributeName: String,\n    override val shortName: String,\n    override val isFaceted: Boolean,\n    override val type: AttributeType = AttributeType.COMPOSITE_ATTR,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val isRequired: Boolean? = null,\n    @field:JsonInclude(JsonInclude.Include.NON_NULL)\n    override val createdAt: LocalDateTime? = null,\n    val subAttributes: List&lt;AttributeDto\u003E\n): AttributeDto(id, attributeName, shortName, isFaceted, type, createdAt, isRequired, listOf())\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОсобняком стоит составной тип атрибутов. Например, атрибут \"Габариты\", может содержать в себе такие под-атрибуты, как: \"Длина\", \"Ширина\" и \"Высота\". Сам составной атрибут не имеет непосредственного списка значений, так как все значения принадлежат конкретным под-атрибутам. \u003C\u002Fp\u003E\u003Ch4\u003Esku_collection\u003C\u002Fh4\u003E\u003Cp\u003EНемаловажной частью варианта товара является его артикул или \u003Ca href=\"https:\u002F\u002Fwww.shopify.com\u002Fblog\u002Fwhat-is-a-stock-keeping-unit\" rel=\"noopener noreferrer nofollow\"\u003EStock Keeping Unit (SKU)\u003C\u002Fa\u003E, который позволяет уникально идентифицировать конкретную единицу хранения товара и отслеживать ее наличие на складе. \u003C\u002Fp\u003E\u003Cp\u003EВ нашем случае, каждый вариант товара будет иметь список артикулов, представленных в следующем виде:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003Edata class Sku(\n    val attrValue: String,\n    val price: BigDecimal,\n    val stock: Int,\n    val sku: String\n)\n\ndata class SkuCollection(\n    val attrName: String,\n    val skus: List&lt;Sku\u003E\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПри формировании \u003Ccode\u003ESkuCollection\u003C\u002Fcode\u003E, один из атрибутов товара будет определяющим для конкретной единицы товара (этот атрибут задается продавцом). Постараюсь пояснить. Например, у нас есть товар \"Футболка Junior Developer\", в нескольких вариантах, определяемых цветами, и каждый вариант имеет несколько размеров, при этом количество штук каждой футболки определенного цвета, определенного размера различается:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eсиняя: XL - 2шт, XXL - 4шт\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eзеленая: M - 3шт, S - 1шт\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eкрасная: XS - 10шт\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EТаким образом, в этом случае атрибут, определяющий конкретную единицу товара - размер, и имменно это хранится в поле \u003Ccode\u003ESkuCollection.attrName\u003C\u002Fcode\u003E. Поле \u003Ccode\u003ESku.price\u003C\u002Fcode\u003E обеспечивает возможность хранить цену товара в зависимости от его артикула. Поле \u003Ccode\u003ESku.stock\u003C\u002Fcode\u003E - указывает количество единиц товара на складе. Для того, чтобы не усложнять проект, сам уникальный Stock Keeping Unit - поле \u003Ccode\u003ESku.sku\u003C\u002Fcode\u003E приходит извне, и наш сервис не отвечает за его формирование и обеспечение уникальности, читаемости и удобства использования.\u003C\u002Fp\u003E\u003Ch4\u003EAttribute и Category\u003C\u002Fh4\u003E\u003Cp\u003EИтак, сервис может хранить товары, их атрибуты и значения в удобном нам формате, но как бытьс тем, чтобы на фронте был удобный UI для создания товаров и заполнения информации об атрибутах? Например, мы хотим добавить новый товар \"Футболка Senior Developer\", для этого нам необходимо на фронте выбрать соответствующую категорию и заполнить обязательные для нее атрибуты, указать артикулы, их количество и цену. При заполнении атрибута \"цвет\" мы хотим, чтобы продавец не руками вводил нужный ему цвет, а выбрал из списка предложенных наиболее подходящий, и только в отсутствии такового - заполнил поле самостоятельно. Аналогично должно быть и с другими атрибутами. Для этого нам необходимо структурированно хранить данные на бэке.\u003C\u002Fp\u003E\u003Cp\u003EДля реализации задачи используются следующие таблицы в БД. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003ECREATE TABLE categories(\n    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,\n    name VARCHAR(255) NOT NULL UNIQUE,\n    parent_id BIGINT REFERENCES categories(id),\n    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE attributes(\n    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,\n    composite_attribute_id BIGINT REFERENCES attributes(id),\n    name VARCHAR(255) NOT NULL UNIQUE,\n    short_name VARCHAR(255) NOT NULL,\n    is_faceted BOOLEAN NOT NULL DEFAULT true,\n    is_composite BOOLEAN NOT NULL DEFAULT false,\n    created_at TIMESTAMP NOT NULL,\n    updated_at TIMESTAMP NOT NULL,\n    numeric_values JSONB,\n    string_values JSONB,\n    color_values JSONB,\n    a_type VARCHAR(8)\n);\n\nCREATE TABLE category_attributes(\n    category_id BIGINT REFERENCES categories(id) NOT NULL,\n    attribute_id BIGINT REFERENCES attributes(id) NOT NULL,\n    is_required BOOLEAN NOT NULL DEFAULT false,\n    PRIMARY KEY(category_id, attribute_id)\n);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДля представления данных об атрибутах в коде используется иерархия, аналогичная той, которая применяется для \u003Ccode\u003EAttributeDto\u003C\u002Fcode\u003E, однако так как в проекте используется Spring Data JPA и Hibernate в качесте persistence provider, необходимо подсказать Hibernate, какой тип наследования использовать. В нашем случае это \u003Ccode\u003EInheritanceType.SINGLE_TABLE\u003C\u002Fcode\u003E - когда данные обо всех подтипах хранятся в одной таблице, а сами подтипы различаются значением, указанным в \u003Ccode\u003E@DiscriminatorValue\u003C\u002Fcode\u003E. Плюсом такого подхода является простота реализации и скорость выборки как при полиморфных запросах, так и при запросе конкретного подтипа. Одним из минусов является невозможность наложить \u003Ccode\u003ENOT NULL\u003C\u002Fcode\u003E ограничения на уровне базы на столбцы, которые присутствуют только в подтипах. \u003C\u002Fp\u003E\u003Cp\u003EСобственно так выглядят сами модели: \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E@Entity\n@Table(name = \"attributes\")\n@Inheritance(strategy = InheritanceType.SINGLE_TABLE)\n@DiscriminatorColumn(name = \"a_type\")\nabstract class Attribute(\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    var id: Long? = null,\n    var name: String,\n    @Column(name = \"short_name\", nullable = false)\n    var shortName: String,\n    @Column(name = \"is_faceted\", nullable = false)\n    var isFaceted: Boolean,\n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = \"composite_attribute_id\")\n    var compositeAttribute: CompositeAttribute? = null\n) {\n\n    @Column(name = \"created_at\")\n    @org.hibernate.annotations.CreationTimestamp\n    var createdAt: LocalDateTime? = null\n\n    @Column(name = \"updated_at\")\n    @org.hibernate.annotations.UpdateTimestamp\n    var updatedAt: LocalDateTime? = null\n\n    override fun equals(other: Any?): Boolean {\n        val o = other as? Attribute ?: return false\n        return id != null &amp;&amp; id == o.id\n    }\n\n    override fun hashCode(): Int {\n        return javaClass.hashCode()\n    }\n}\n\n@Entity\n@DiscriminatorValue(\"SA\")\nclass StringAttribute(\n    name: String,\n    shortName: String,\n    isFaceted: Boolean,\n    @org.hibernate.annotations.Type(JsonBinaryType::class)\n    @Column(name = \"string_values\", columnDefinition = \"jsonb\")\n    var stringValues: MutableList&lt;StringAttributeValueDto\u003E = arrayListOf()\n) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted)  {\n\n    override fun toString(): String {\n        return \"StringAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)\"\n    }\n}\n\n@Entity\n@DiscriminatorValue(\"NA\")\nclass NumericAttribute(\n    name: String,\n    shortName: String,\n    isFaceted: Boolean,\n    @org.hibernate.annotations.Type(JsonBinaryType::class)\n    @Column(name = \"numeric_values\", columnDefinition = \"jsonb\")\n    var numericValues: MutableList&lt;NumericAttributeValueDto\u003E = arrayListOf()\n) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted) {\n\n    override fun toString(): String {\n        return \"NumericAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)\"\n    }\n}\n\n@Entity\n@DiscriminatorValue(\"CLA\")\nclass ColorAttribute(\n    name: String,\n    shortName: String,\n    isFaceted: Boolean,\n    @org.hibernate.annotations.Type(JsonBinaryType::class)\n    @Column(name = \"color_values\", columnDefinition = \"jsonb\")\n    var colorValues: MutableList&lt;ColorAttributeValueDto\u003E = arrayListOf()\n) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted) {\n\n    override fun toString(): String {\n        return \"ColorAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)\"\n    }\n}\n\n@Entity\n@DiscriminatorValue(\"CA\")\nclass CompositeAttribute(\n    name: String,\n    shortName: String,\n    isFaceted: Boolean,\n    @OneToMany(mappedBy = \"compositeAttribute\", cascade = [CascadeType.PERSIST])\n    var subAttributes: MutableSet&lt;Attribute\u003E = hashSetOf()\n) : Attribute(name = name, shortName = shortName, isFaceted = isFaceted) {\n\n    override fun toString(): String {\n        return \"CompositeAttribute(id=$id, name='$name', shortName='$shortName', isFaceted=$isFaceted)\"\n    }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EДля того, чтобы Hibernate корректно конвертировал наш тип данных в JSONB и обратно необходимо добавить в проект зависимость на Hypersistence Utils \u003Ccode\u003Eio.hypersistence:hypersistence-utils-hibernate-63:3.7.0\u003C\u002Fcode\u003E \u003Cbr\u002F\u003E(версию необходимо кореллировать с версией Hibernate), а также указать аннотацию \u003Ccode\u003E@org.hibernate.annotations.Type(JsonBinaryType::class)\u003C\u002Fcode\u003E над требуемым полем. Более подробно о том, как мапить данные в JSONB можно почитать \u003Ca href=\"https:\u002F\u002Fvladmihalcea.com\u002Fhow-to-map-json-objects-using-generic-hibernate-types\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eтут\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EСобственно на этом заканчивается описание модели данных, и начинается работа с \u003Ca href=\"https:\u002F\u002Fwww.postgresql.org\u002Fdocs\u002F16\u002Ffunctions-json.html\" rel=\"noopener noreferrer nofollow\"\u003Eфункциями Postgres для JSONB\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003Ch3\u003EОбновление с помощью jsonb_set\u003C\u002Fh3\u003E\u003Cp\u003EОсновная логика, связанная с обновлением данных о варианте товара с помощью функции \u003Ccode\u003Ejsonb_set\u003C\u002Fcode\u003E находится в репозитории: \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Faasmc\u002Fproduct-service-demo\u002Fblob\u002Fmaster\u002Fsrc\u002Fmain\u002Fkotlin\u002Fru\u002Faasmc\u002Fproductservice\u002Fstorage\u002Frepository\u002FProductVariantRepository.kt\" rel=\"noopener noreferrer nofollow\"\u003EProductVariantRepository\u003C\u002Fa\u003E. Рассмотрим подробно несколько SQL запросов. К сожалению, при использовании Spring Data JPA мы можем использовать только нативные запросы, если хотим работать с \u003Ccode\u003Ejsonb_set\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Ch4\u003EОбновляем цену артикула\u003C\u002Fh4\u003E\u003Cp\u003EНачнем с простого. Будем исходить из знания о том, что в таблице \u003Ccode\u003Eproduct_variants\u003C\u002Fcode\u003E хранится запись о товаре со следующим списком артикулов:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"json\"\u003E{\n    \"attrName\": \"clothes size\",\n    \"skus\": [\n      {\n        \"attrValue\": \"XS\",\n        \"price\": 10,\n        \"stock\": 10,\n        \"sku\": \"t-shirt\u002Fblue\u002FXS\u002FBrand\u002F230\"\n      },\n      {\n        \"attrValue\": \"S\",\n        \"price\": 10,\n        \"stock\": 10,\n        \"sku\": \"t-shirt\u002Fblue\u002FS\u002FBrand\u002F231\"\n      },\n      {\n        \"attrValue\": \"M\",\n        \"price\": 10,\n        \"stock\": 10,\n        \"sku\": \"t-shirt\u002Fblue\u002FM\u002FBrand\u002F232\"\n      }\n    ]\n  }\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EИ нам требуется изменить цену нулевого артикула с \u003Ccode\u003Esku=\"t-shirt\u002Fblue\u002FXS\u002FBrand\u002F230\"\u003C\u002Fcode\u003E. Чтобы этого добиться мы можем воспользоваться функцией \u003Ccode\u003Ejsonb_set\u003C\u002Fcode\u003E. Ниже приведу полное ее описание из документации. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Ejsonb_set ( target jsonb, path text[], new_value jsonb [, create_if_missing boolean ] ) → jsonb\nReturns target with the item designated by path replaced by new_value, or with new_value added if create_if_missing is true (which is the default) and the item designated by path does not exist. All earlier steps in the path must exist, or the target is returned unchanged. As with the path oriented operators, negative integers that appear in the path count from the end of JSON arrays. If the last path step is an array index that is out of range, and create_if_missing is true, the new value is added at the beginning of the array if the index is negative, or at the end of the array if it is positive.\njsonb_set('[{\"f1\":1,\"f2\":null},2,null,3]', '{0,f1}', '[2,3,4]', false) → [{\"f1\": [2, 3, 4], \"f2\": null}, 2, null, 3]\njsonb_set('[{\"f1\":1,\"f2\":null},2]', '{0,f3}', '[2,3,4]') → [{\"f1\": 1, \"f2\": null, \"f3\": [2, 3, 4]}, 2]\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EИтак, из документации становится понятно, что для того, чтобы обновить значение в JSONB, нам необходимо найти конкретный путь до поля, значение которого мы хотим поменять. В нашем случае - это \u003Ccode\u003E'{sku,0,price}'\u003C\u002Fcode\u003E, где 0 - индекс конкретного элемента \u003Ccode\u003ESku\u003C\u002Fcode\u003E в списке. Однако при получении запроса на обновление нам не передается индекс. Для того, чтобы его найти, воспользуемся CTE и функцией \u003Ccode\u003Ejsonb_array_elements\u003C\u002Fcode\u003E, раскрывающей элементы из JSON списка во множество значений. Также нам потребуется выражение \u003Ccode\u003EWITH ORDINALITY\u003C\u002Fcode\u003E, которое добавляет в выходные данные столбец типа \u003Ccode\u003Ebigint\u003C\u002Fcode\u003E, числа в котором начинаются с 1 и увеличиваются на 1 для каждой строки, выданной функцией. Тут стоит учитывать, что индексы в JSONB начинаются с 0, поэтому из полученного с помощью \u003Ccode\u003EWITH ORDINALITY\u003C\u002Fcode\u003E индекса необходимо вычесть единицу. Также стоит запомнить, что \u003Ccode\u003EWITH ORDINALITY\u003C\u002Fcode\u003Eвозвращает \u003Ccode\u003Ebigint\u003C\u002Fcode\u003E, а индексы в пути  для \u003Ccode\u003Ejsonb_set\u003C\u002Fcode\u003E должны быть типа \u003Ccode\u003Eint\u003C\u002Fcode\u003E, и нам в дальнейшем понадобится их кастить. Так как путь должен быть приведен к типу \u003Ccode\u003Etext[]\u003C\u002Fcode\u003E, воспользуемся нативным синтаксисом Postgres. При приведении необходимо экранировать двоеточия обратным слэшем.\u003C\u002Fp\u003E\u003Cp\u003EТак выглядит CTE:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003EWITH sku_path AS (\n    SELECT ('{skus,'||index - 1||',price}')\\:\\:text[] AS path\n    FROM product_variants, jsonb_array_elements(sku_collection-\u003E'skus') WITH ORDINALITY arr(sku_element, index)\n    WHERE id = :variantId AND sku_element-\u003E\u003E'sku' = :sku\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EТакже стоит обратить внимание на специфичный для JSONB оператор \u003Ccode\u003E-\u003E\u003E\u003C\u002Fcode\u003E. Он возвращает значение в виде строки. \u003C\u002Fp\u003E\u003Cp\u003EОсталось дело за малым - передать полученный путь в функцию \u003Ccode\u003Ejsonb_set\u003C\u002Fcode\u003E. Так будет выглядеть метод для обновления цены артикула:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E@Modifying\n@Query(\n  value = \"\"\"\n          WITH sku_path AS (\n              SELECT ('{skus,'||index - 1||',price}')\\:\\:text[] AS path\n              FROM product_variants, jsonb_array_elements(sku_collection-\u003E'skus') WITH ORDINALITY arr(sku_element, index)\n              WHERE id = :variantId AND sku_element-\u003E\u003E'sku' = :sku\n          )\n          UPDATE product_variants\n          SET sku_collection = jsonb_set(sku_collection, sku_path.path, to_jsonb(:newPrice), false)\n          FROM sku_path \n          WHERE id = :variantId\n       \"\"\", nativeQuery = true\n)\nfun updateSkuPrice(\n  @Param(\"sku\") sku: String,\n  @Param(\"variantId\") variantId: Long,\n  @Param(\"newPrice\") newPrice: BigDecimal\n): Int\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4\u003EДобавление в конец списка\u003C\u002Fh4\u003E\u003Cp\u003EТеперь предположим, что нам требуется добавить в конец списка в JSONB какое-то значение, например, еще одну фотографию. \u003C\u002Fp\u003E\u003Cp\u003EДопустим, сейчас храниться только одно фото в image_collection:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"json\"\u003E{\n  \"images\": [\n    {\"url\":\"http:\u002F\u002Fimages.com\u002Fold_blue_image.png\",\"isPrimary\":true}\n  ]\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКак и в предыдущем случае воспользуемся функцией \u003Ccode\u003Ejsonb_set\u003C\u002Fcode\u003E. Сейчас мы изначально знаем путь до элемента JSONB, в конец которого добавляем новый элемент, поэтому нам не понадобится CTE. Однако нам необходимо сконвертировать добавляемый в коллекцию класс \u003Ccode\u003EAppImage\u003C\u002Fcode\u003E в строку в виде JSON, так как иначе мы не сможем его скастить к типу \u003Ccode\u003Ejsonb\u003C\u002Fcode\u003E. Для добавления в конец списка используется оператор \u003Ccode\u003E||\u003C\u002Fcode\u003E. Полный запрос будет выглядеть следующим образом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E@Modifying\n@Query(\n  \"\"\"\n       UPDATE product_variants\n       SET image_collection = jsonb_set(image_collection, '{images}', (image_collection-\u003E'images')\\:\\:jsonb || (:photo)\\:\\:jsonb, false)\n       WHERE id = :variantId\n   \"\"\", nativeQuery = true\n)\nfun addImage(\n  @Param(\"variantId\") variantId: Long,\n  @Param(\"photo\") photo: String\n): Int\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4\u003EУдаление из списка\u003C\u002Fh4\u003E\u003Cp\u003EК сожалению, нет функции, которая позволяет просто удалить значение из списка в JSONB. Однако это не безвыходная ситуация. Можем воспользоваться комбинацией функций: \u003Ccode\u003Ejsonb_set\u003C\u002Fcode\u003E, \u003Ccode\u003Ejsonb_array_elements\u003C\u002Fcode\u003E и \u003Ccode\u003Ejsonb_agg\u003C\u002Fcode\u003E. Первые две уже знакомы, \u003Ccode\u003Ejsonb_agg\u003C\u002Fcode\u003E аггрегирует передаваемые значения в JSON список. \u003C\u002Fp\u003E\u003Cp\u003EЛогика удаления такая: проходим по каждому элементу списка,  оставляем в нем только те элементы, которые не удовлетворяют условию удаления, агрегируем их обратно в список. Но тут есть важный момент: если после удаления в результирующем списке не останется элементов, то \u003Ccode\u003Ejsonb_agg\u003C\u002Fcode\u003E вернет \u003Ccode\u003ENULL\u003C\u002Fcode\u003E, а нам требуется сформировать пустой список. Для этого воспользуемся функцией \u003Ccode\u003ECOALESCE\u003C\u002Fcode\u003E, которая оставляет первое не \u003Ccode\u003ENULL\u003C\u002Fcode\u003E значение. Первым параметром будет результат \u003Ccode\u003Ejsonb_agg\u003C\u002Fcode\u003E, а вторым - пустой список. \u003C\u002Fp\u003E\u003Cp\u003EСам запрос:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E@Modifying\n@Query(\n  \"\"\"\n       UPDATE product_variants\n       SET image_collection = jsonb_set(\n           image_collection,\n           '{images}',\n           COALESCE(\n               (SELECT jsonb_agg(elem) \n               FROM jsonb_array_elements(image_collection-\u003E'images') elem \n               WHERE elem-\u003E\u003E'url' != :imageUrl),\n               '[]'\\:\\:jsonb\n           )    \n       )\n       WHERE id = :variantId\n   \"\"\", nativeQuery = true\n)\nfun removeImage(\n  @Param(\"variantId\") variantId: Long,\n  @Param(\"imageUrl\") imageUrl: String\n): Int\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4\u003EУдаление из списка при двойной вложенности\u003C\u002Fh4\u003E\u003Cp\u003EДопустим, что сейчас у товара следующий набор атрибутов:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"json\"\u003E{\n  \"attributes\": [\n    {\n      \"id\": \"colorAttrId\",\n      \"attributeName\": \"color\",\n      \"shortName\": \"color\",\n      \"isFaceted\": true,\n      \"type\": \"color\",\n      \"isRequired\": true,\n      \"availableValues\": [\n        {\n          \"colorValue\": \"red\",\n          \"colorHex\": \"FF0000\",\n          \"type\": \"color_type\"\n        }\n      ]\n    },\n    {\n      \"id\": \"dimensId\",\n      \"attributeName\": \"clothes dimensions\",\n      \"shortName\": \"dimensions\",\n      \"isFaceted\": true,\n      \"type\": \"composite\",\n      \"isRequired\": false,\n      \"subAttributes\": [\n        {\n          \"attributeName\": \"width\",\n          \"shortName\": \"width\",\n          \"isFaceted\": true,\n          \"type\": \"numeric\",\n          \"availableValues\": [\n            {\n              \"numValue\": 10.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            },\n            {\n              \"numValue\": 20.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            },\n            {\n              \"numValue\": 30.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            }\n          ]\n        },\n        {\n          \"attributeName\": \"length\",\n          \"shortName\": \"length\",\n          \"isFaceted\": true,\n          \"type\": \"numeric\",\n          \"availableValues\": [\n            {\n              \"numValue\": 10.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            },\n            {\n              \"numValue\": 20.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            },\n            {\n              \"numValue\": 30.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            }\n          ]\n        },\n        {\n          \"attributeName\": \"depth\",\n          \"shortName\": \"depth\",\n          \"isFaceted\": true,\n          \"type\": \"numeric\",\n          \"availableValues\": [\n            {\n              \"numValue\": 10.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            },\n            {\n              \"numValue\": 20.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            },\n            {\n              \"numValue\": 30.0,\n              \"numRuValue\": null,\n              \"numUnit\": \"mm\",\n              \"type\": \"numeric_type\"\n            }\n          ]\n        }\n      ],\n      \"availableValues\": []\n    }\n  ]\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EИ нам необходимо в атрибуте \"clothes dimensions\", в под-атрибуте \"width\" удалить значение \"numValue\" = 10.0. Для того, чтобы это сделать, нам придется:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EНайти индекс атрибута с названием \"clothes dimensions\"\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003EWITH attr_path AS (\n      SELECT CAST((index - 1) AS INTEGER) AS idx \n      FROM product_variants, jsonb_array_elements(attribute_collection-\u003E'attributes') WITH ORDINALITY arr(elem, index)\n      WHERE id = :variantId AND elem-\u003E\u003E'attributeName' = :attrName\n),\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Col start=\"2\"\u003E\u003Cli\u003E\u003Cp\u003EНайти индекс под-атрибута с названием \"width\" и сформировать путь до списка \u003Ccode\u003EavailableValues\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003Esub_attr_path AS (\n    SELECT('{attributes,'||(SELECT idx FROM attr_path)||',subAttributes,'||index - 1||',availableValues}')\\:\\:text[] as path,\n    CAST((index - 1) AS INTEGER) AS idx\n    FROM product_variants, jsonb_array_elements(attribute_collection-\u003E'attributes'-\u003E(SELECT idx AS INTEGER FROM attr_path)-\u003E'subAttributes') WITH ORDINALITY arr(elem, index)\n    WHERE id = :variantId AND elem-\u003E\u003E'attributeName' = :subAttrName\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Col start=\"3\"\u003E\u003Cli\u003E\u003Cp\u003EПройти по списку \"availableValues\" и оставить в нем только те, элементы, которые не удовлетворяют условию удаления - то есть все, не равные 10.0.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cpre\u003E\u003Ccode class=\"sql\"\u003ECOALESCE(\n         (SELECT jsonb_agg(elem)\n             FROM jsonb_array_elements(attribute_collection-\u003E'attributes'-\u003Eap.idx-\u003E'subAttributes'-\u003Esap.idx-\u003E'availableValues') elem\n             WHERE CAST(elem-\u003E\u003E'numValue' AS DOUBLE PRECISION) != :numValue \n         ),\n         '[]'\\:\\:jsonb\n     )\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ целом задача похожа на предыдущие, только добавляется второй уровень вложенности. Общий запрос выглядит следующим образом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"kotlin\"\u003E@Modifying\n@Query(\"\"\"\n       WITH attr_path AS (\n           SELECT CAST((index - 1) AS INTEGER) AS idx \n           FROM product_variants, jsonb_array_elements(attribute_collection-\u003E'attributes') WITH ORDINALITY arr(elem, index)\n           WHERE id = :variantId AND elem-\u003E\u003E'attributeName' = :attrName\n       ),\n        sub_attr_path AS (\n           SELECT('{attributes,'||(SELECT idx FROM attr_path)||',subAttributes,'||index - 1||',availableValues}')\\:\\:text[] as path,\n           CAST((index - 1) AS INTEGER) AS idx\n           FROM product_variants, jsonb_array_elements(attribute_collection-\u003E'attributes'-\u003E(SELECT idx AS INTEGER FROM attr_path)-\u003E'subAttributes') WITH ORDINALITY arr(elem, index)\n           WHERE id = :variantId AND elem-\u003E\u003E'attributeName' = :subAttrName\n       )\n       UPDATE product_variants\n       SET attribute_collection = jsonb_set(\n           attribute_collection,\n           sap.path,\n           COALESCE(\n                    (SELECT jsonb_agg(elem)\n                        FROM jsonb_array_elements(attribute_collection-\u003E'attributes'-\u003Eap.idx-\u003E'subAttributes'-\u003Esap.idx-\u003E'availableValues') elem\n                        WHERE CAST(elem-\u003E\u003E'numValue' AS DOUBLE PRECISION) != :numValue \n                    ),\n                    '[]'\\:\\:jsonb\n                )\n       )\n       FROM attr_path ap, sub_attr_path sap \n       WHERE id = :variantId\n   \"\"\", nativeQuery = true)\nfun removeCompositeAttributeNumericValue(\n  @Param(\"variantId\") variantId: Long,\n  @Param(\"attrName\") attrName: String,\n  @Param(\"subAttrName\") subAttrName: String,\n  @Param(\"numValue\") numValue: Double,\n  ): Int\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EОстальные запросы очень похожи на то, что разобрано выше, поэтому не составят труда для понимания. Для наглядности в проекте есть тесты как \u003Ccode\u003EProductVariantRepository\u003C\u002Fcode\u003E, так и \u003Ccode\u003EProductVariantController\u003C\u002Fcode\u003E - запуск тестов потребует наличия \u003Ccode\u003EDocker\u003C\u002Fcode\u003E, так как используется библиотека \u003Ccode\u003ETestContainers\u003C\u002Fcode\u003E. \u003C\u002Fp\u003E\u003Cp\u003EДополнительно хочу сказать, что функционал работы с JSONB в Postgres гораздо обширнее того, что рассмотрено выше: поддерживается множество других функций, \u003Ca href=\"https:\u002F\u002Fwww.postgresql.org\u002Fdocs\u002F16\u002Ffunctions-aggregate.html\" rel=\"noopener noreferrer nofollow\"\u003Eаггрегирующие операторы\u003C\u002Fa\u003E, можно \u003Ca href=\"https:\u002F\u002Fpostgrespro.ru\u002Fdocs\u002Fpostgrespro\u002F9.5\u002Fdatatype-json\" rel=\"noopener noreferrer nofollow\"\u003Eсоздать GIN индекс\u003C\u002Fa\u003E с классом операторов \u003Ccode\u003Ejsonb_ops\u003C\u002Fcode\u003E или \u003Ccode\u003Ejsonb_path_ops,\u003C\u002Fcode\u003E отличающихся по набору доступных операторов, производительности и памяти. \u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"Kotlin"},{"titleHtml":"spring-boot"},{"titleHtml":"java"},{"titleHtml":"postgres"},{"titleHtml":"jsonb"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F793438\u002F8fbfba2d3364876880814a61f6992823\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F793438\u002F8fbfba2d3364876880814a61f6992823\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F793438\\\u002F\"},\"headline\":\"Использование Postgres и JSONB для хранения товаров, характеристик и цен\",\"datePublished\":\"2024-02-13T14:53:29+03:00\",\"dateModified\":\"2024-02-13T16:58:20+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"aasmc\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Farticles\\\u002F793438\\\u002F#post-content-body\",\"about\":[\"h_postgresql\",\"h_java\",\"h_kotlin\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F793438\\\u002F8fbfba2d3364876880814a61f6992823\\\u002F\"]}","metaDescription":"Всем привет! Меня зовут Александр, в данное время я на фрилансе занимаюсь проектом по созданию очередного маркетплейса. В процессе работы мы столкнулись с далеко не новой проблемой организации...","mainImageUrl":null,"amp":true,"customTrackerLinks":[]},"polls":[],"commentsEnabled":{"status":true,"reason":null},"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":"tutorial","banner":null,"multiwidget":null,"readingTime":17,"complexity":"medium","isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"postReasonsList":null,"view":"list","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"viewedPosts":[],"myFeedFilter":{"complexity":"all","score":"all","types":["articles","posts","news"]},"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[{"title":"Java разработчик","vacanciesCount":411,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fjava_developer","itemHubs":["java","javame_dev","gradle"]}],"hubs":"postgresql,java,kotlin"},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"multiwidgets":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"multiwidgetLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"pagesCount":0},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"flows":{"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}],"updates":{}},"global":{"isPwa":false,"device":"mobile","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"welcomePage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"query":{},"pathname":"\u002Fru\u002Farticles\u002F793438\u002F","path":"\u002Fru\u002Farticles\u002F793438\u002F","href":"\u002Fru\u002Farticles\u002F793438\u002F"}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null,"userUpdates":{"feeds":{"newPostsCount":null,"newThreadsCount":null,"newNewsCount":null,"newCount":null},"conversationUnreadCount":0}},"modal":{"modals":[]},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"vacancies":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-692","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcb9\u002F057\u002Ff05\u002Fcb9057f053dddd9c558ead203cbbf6db.png","title":"Хабр","link":null},"title":"Любовь, Хабр и роботы","lang":"ru","startTime":"2024-02-13T11:48:00+03:00","finishTime":"2024-03-03T11:48:00+03:00","slides":[{"id":"story-692_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F020\u002F196\u002Fac1\u002F020196ac13448aa27b806cb7a57acb53.jpg","button":null},{"id":"story-692_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4d5\u002F880\u002Fc76\u002F4d5880c7643117f9905f71d2c2909a3e.jpg","button":{"title":"Промпты","link":"https:\u002F\u002Fu.habr.com\u002Fval-01","colorType":"light"}},{"id":"story-692_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3bb\u002F287\u002F735\u002F3bb2877357a77cc9af6dc18407c8b645.jpg","button":{"title":"Светодиодное","link":"https:\u002F\u002Fu.habr.com\u002Fval-02","colorType":"light"}},{"id":"story-692_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F70c\u002Fd47\u002F15e\u002F70cd4715e01b5a4022d9d4bcd51dfdd4.jpg","button":{"title":"404 и прочие","link":"https:\u002F\u002Fu.habr.com\u002Fval-03","colorType":"light"}},{"id":"story-692_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa63\u002F52e\u002F099\u002Fa6352e0994932361a91257afecf032c5.jpg","button":{"title":"Задания","link":"https:\u002F\u002Fu.habr.com\u002Fval-04","colorType":"light"}},{"id":"story-692_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc48\u002F5ab\u002F815\u002Fc485ab81504423e30f61e9da37424990.jpg","button":{"title":"Эволюция","link":"https:\u002F\u002Fu.habr.com\u002Fval-05","colorType":"light"}},{"id":"story-692_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F472\u002F7a6\u002F5fb\u002F4727a65fb74b2708a8dda1c218f966a6.jpg","button":{"title":"Ювелирная история","link":"https:\u002F\u002Fu.habr.com\u002Fval-06","colorType":"light"}},{"id":"story-692_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7a5\u002F5c6\u002F3e0\u002F7a55c63e08ce8c44d319b787c5a9a927.jpg","button":{"title":"Много идей","link":"https:\u002F\u002Fu.habr.com\u002Fval-07","colorType":"light"}},{"id":"story-692_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F080\u002Fb92\u002Fe0e\u002F080b92e0e6fe4a23c3375aa30982035d.jpg","button":{"title":"Трудный путь","link":"https:\u002F\u002Fu.habr.com\u002Fval-08","colorType":"light"}}]},{"id":"story-690","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb2a\u002F177\u002Fa79\u002Fb2a177a796e733d3aca64dc0295b96d2.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002Fur0lk"},"title":"Рейтинг IT-работодателей 2023","lang":"ru","startTime":"2024-02-12T10:46:00+03:00","finishTime":"2024-02-20T23:46:00+03:00","slides":[{"id":"story-690_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed1\u002F163\u002F316\u002Fed1163316cda93393a7068d9bc03b84b.png","button":null},{"id":"story-690_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F20d\u002F196\u002Fbef\u002F20d196bef3f4f340495a4182b8fe02db.png","button":null},{"id":"story-690_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa84\u002F35c\u002F847\u002Fa8435c847a08f81f417c88b6c533db27.png","button":null},{"id":"story-690_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6ff\u002Ff2e\u002F0c0\u002F6fff2e0c0a7c8740c3df51835ddc9db6.png","button":null},{"id":"story-690_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0a8\u002Ffa4\u002F179\u002F0a8fa4179e6c2820395ae4211b95fb21.png","button":{"title":"Смотреть","link":"https:\u002F\u002Fu.habr.com\u002Fur0lk","colorType":"dark"}}]},{"id":"story-506","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F753\u002Fae1\u002F362\u002F753ae13628d05b3bc057376584dd9267.png","title":"Хабр","link":null},"title":"Прокачать коммуникацию","lang":"ru","startTime":"2024-02-12T10:00:00+03:00","finishTime":"2024-02-19T13:39:00+03:00","slides":[{"id":"story-506_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3f8\u002Fadf\u002F179\u002F3f8adf1799b21a8a304cd8210c984d7d.jpg","button":null},{"id":"story-506_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7a0\u002F315\u002F3b0\u002F7a03153b0ce7ee682b655c64c556fa07.jpg","button":{"title":"Сломать барьеры","link":"https:\u002F\u002Fu.habr.com\u002Fcm_01","colorType":"light"}},{"id":"story-506_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F057\u002F368\u002F973\u002F057368973837d7617b1c683f597837a0.jpg","button":{"title":"Мнения","link":"https:\u002F\u002Fu.habr.com\u002Fcm_02","colorType":"light"}},{"id":"story-506_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd96\u002Fe1a\u002F007\u002Fd96e1a0077651fbe6790fc9e56a1d22a.jpg","button":{"title":"17 трюков","link":"https:\u002F\u002Fu.habr.com\u002Fcm_03","colorType":"light"}},{"id":"story-506_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9fd\u002F9a4\u002F6c6\u002F9fd9a46c687c9de10f3e1dc697255568.jpg","button":{"title":"Алгоритмы","link":"https:\u002F\u002Fu.habr.com\u002Fcm_04","colorType":"light"}},{"id":"story-506_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe63\u002Fe07\u002F833\u002Fe63e078332f4f35121c20f70bcfec021.jpg","button":{"title":"Схемы и таблицы","link":"https:\u002F\u002Fu.habr.com\u002Fcm_05","colorType":"light"}},{"id":"story-506_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F248\u002F416\u002F517\u002F24841651762d9b1996fadf5c3f6c67d6.jpg","button":{"title":"Пути к сети","link":"https:\u002F\u002Fu.habr.com\u002Fcm_06","colorType":"light"}},{"id":"story-506_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4e9\u002F964\u002F37f\u002F4e996437fb88e533e4431e4b9b21e0c9.jpg","button":{"title":"Инструкция","link":"https:\u002F\u002Fu.habr.com\u002Fcm_07","colorType":"light"}}]},{"id":"story-552","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F310\u002Fb6d\u002F097\u002F310b6d09710575fad755fc8ed317c7ec.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fcalendar_story_2"},"title":"Перевернуть календарь и добавить событие","lang":"ru","startTime":"2024-02-12T05:29:00+03:00","finishTime":"2024-02-25T23:59:00+03:00","slides":[{"id":"story-552_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffd3\u002F1a4\u002F6ab\u002Ffd31a46abecfbc6f654e64a66cb66260.jpg","button":{"title":"Прямо сюда","link":"https:\u002F\u002Fu.habr.com\u002Fez25C","colorType":"dark"}},{"id":"story-552_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffef\u002F3e3\u002Fb5d\u002Ffef3e3b5d8379c976167169334348272.jpg","button":{"title":"Разместить событие","link":"https:\u002F\u002Fu.habr.com\u002Fez25C","colorType":"light"}},{"id":"story-552_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8b9\u002Fea9\u002F638\u002F8b9ea9638d36013b31e365ec79b96d2d.jpg","button":{"title":"Тык","link":"https:\u002F\u002Fu.habr.com\u002Fez25C","colorType":"dark"}}]},{"id":"story-688","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb2f\u002Fa90\u002F65c\u002Fb2fa9065c28c671c672625a4e1097d21.png","title":"Хабр","link":null},"title":"Хорошие статьи из блогов компаний","lang":"ru","startTime":"2024-02-08T12:20:00+03:00","finishTime":"2024-02-16T12:20:00+03:00","slides":[{"id":"story-688_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff23\u002F0b0\u002Fc0c\u002Ff230b0c0c0d09cea5345411d5bcc5362.jpg","button":null},{"id":"story-688_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F537\u002Faba\u002F727\u002F537aba7270a7d64089382a1851b0b523.jpg","button":{"title":"Подозреваемые","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fru_mts\u002Farticles\u002F788122\u002F","colorType":"dark"}},{"id":"story-688_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc37\u002F189\u002F8fe\u002Fc371898fe6fcb7d9e893bde16e510a34.jpg","button":{"title":"Игроки и ходы","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fraft\u002Farticles\u002F787906\u002F","colorType":"light"}},{"id":"story-688_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb09\u002F711\u002F60c\u002Fb0971160cde978e26950e68f1bb971c3.jpg","button":{"title":"Чудеса техники","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Ftimeweb\u002Farticles\u002F788194\u002F","colorType":"light"}},{"id":"story-688_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff95\u002Fdde\u002F15a\u002Ff95dde15a019ef12d13b7638551ae1d8.jpg","button":{"title":"Болезни и лечение","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fkaspersky\u002Farticles\u002F787586\u002F","colorType":"light"}},{"id":"story-688_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8ab\u002Fc05\u002Fcfe\u002F8abc05cfee41e22af2653f655f2a70a6.jpg","button":{"title":"Взгляд в прошлое","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Falfa\u002Farticles\u002F790206\u002F","colorType":"light"}},{"id":"story-688_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb1e\u002F975\u002F0ae\u002Fb1e9750aed7dc66ea2bce6b9ca2c429e.jpg","button":{"title":"Читать гайд","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fruvds\u002Farticles\u002F786698\u002F","colorType":"dark"}},{"id":"story-688_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4d2\u002Fb02\u002F667\u002F4d2b02667f6021e454ab8374a4fc6299.jpg","button":{"title":"Часть первая","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fgazprombank\u002Farticles\u002F788978\u002F","colorType":"light"}}]},{"id":"story-686","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9ff\u002F7d2\u002F49e\u002F9ff7d249ee153370739013582d09db45.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002F1WA80"},"title":"Зарплаты в IT во второй половине 2023","lang":"ru","startTime":"2024-02-07T12:39:00+03:00","finishTime":"2024-02-19T23:45:00+03:00","slides":[{"id":"story-686_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6d3\u002F28b\u002Fb86\u002F6d328bb868356b81140070b5b3a96942.png","button":null},{"id":"story-686_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffe9\u002F048\u002F5f1\u002Ffe90485f150ef9012a19c340400d6b3a.png","button":null},{"id":"story-686_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa65\u002F21c\u002F254\u002Fa6521c254ff6ac9a829770908d52f7be.png","button":null},{"id":"story-686_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1bd\u002Faba\u002Fc21\u002F1bdabac214efe2e7f05013baa49f9c57.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002F1WA80","colorType":"light"}},{"id":"story-686_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F85a\u002F9a7\u002F28e\u002F85a9a728e98e562781f08cb3ba74d3cd.png","button":{"title":"Узнать зарплаты","link":"https:\u002F\u002Fu.habr.com\u002F1WA80","colorType":"light"}}]},{"id":"story-684","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F921\u002F711\u002F6a7\u002F9217116a7a63fd5722272dcb0784a497.png","title":"Хабр","link":null},"title":"Учим английский","lang":"ru","startTime":"2024-02-05T11:05:00+03:00","finishTime":"2024-02-18T11:05:00+03:00","slides":[{"id":"story-684_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3e7\u002Ff22\u002F9f6\u002F3e7f229f66db5b301ac57509bf8dec1e.png","button":{"title":"Профиль @varagian","link":"https:\u002F\u002Fu.habr.com\u002FphV0O","colorType":"dark"}},{"id":"story-684_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F780\u002F841\u002F304\u002F7808413045827f2d4359760e29b1f6c5.jpg","button":{"title":"Слова, слова","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fepam_systems\u002Farticles\u002F483384\u002F","colorType":"light"}},{"id":"story-684_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa2e\u002F040\u002F42b\u002Fa2e04042b05bc757738d1b39e9a94b45.jpg","button":{"title":"От А0 до С2","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F711404\u002F","colorType":"dark"}},{"id":"story-684_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F469\u002Fef6\u002Fb10\u002F469ef6b104e23e49e6db1b86a54386f6.jpg","button":{"title":"Путь к B2","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F784376\u002F","colorType":"dark"}},{"id":"story-684_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F953\u002F43f\u002F816\u002F95343f81610717241b139f0b38d1c98d.jpg","button":{"title":"От первого лица","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompanies\u002Fit-guide\u002Farticles\u002F785360\u002F","colorType":"light"}},{"id":"story-684_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc05\u002F626\u002F6cc\u002Fc056266ccf35f7eb54ff9cba64485fce.jpg","button":{"title":"Устаревшее","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F580504\u002F","colorType":"light"}},{"id":"story-684_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2d4\u002Fddb\u002F4e1\u002F2d4ddb4e1f198ff6382d335388497b19.jpg","button":{"title":"Что это за магия","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F787910\u002F","colorType":"light"}},{"id":"story-684_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1a5\u002Fbd0\u002Fde7\u002F1a5bd0de7a25e08f717b0d26b9830a99.jpg","button":{"title":"Что из чего","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F43165\u002F","colorType":"light"}},{"id":"story-684_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F092\u002F0c0\u002F731\u002F0920c0731e7f3470137547c434d08ac5.jpg","button":{"title":"Методы","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Farticles\u002F710628\u002F","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"notificationsLoading":false,"notificationsList":[],"notificationsPageCount":0,"pendingMarkNotificationsRead":[],"publicationsLoading":true,"publicationsList":[],"publicationsPageCount":0,"pendingDeletePublications":false,"pendingMarkPublicationsRead":false},"events":{"events":[{"id":"events_130","titleHtml":"Как использовать облачные платформы Сloud.ru: серия демо-встреч по четвергам","descriptionHtml":"\u003Cp\u003EВ формате еженедельных 30-минутных онлайн-встреч расскажем о возможностях облачных платформ Сloud.ru и потенциале их использования. В прямом эфире эксперты Cloud.ru покажут, как работают облачные платформы и ответят на вопросы участников.\u003C\u002Fp\u003E\u003Cp\u003EОбщая программа встреч:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eвведение: какие задачи помогают решить облачные платформы Cloud.ru Advanced, Cloud.ru Enterprise и Cloud.ru Evolution;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eобзор конкретной платформы и облачных сервисов, регистрация в личном кабинете;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eответы на вопросы.&nbsp;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EБудет полезно тем, кто только задумывается о переезде в облако и планирует узнать о нем больше. А также тем, кто уже использует облачные технологии и хочет задать вопросы эксперту или получить совет по работе с платформой.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F48c\u002F817\u002Ff0b\u002F48c817f0b52e6b603845a694cb2cd251.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_cloudru","startDay":"2024-02-01","startTime":"11:00","finishDay":"2024-02-29","isOnline":true,"geo":[]},{"id":"events_154","titleHtml":"Конкурс грантов на обучение IT-профессиям от Хекслета","descriptionHtml":"\u003Cp\u003EДарим три гранта на бесплатное обучение IT-профессии в группе с наставником.\u003C\u002Fp\u003E\u003Cp\u003EДля участия необходимо до 29 февраля пройти не менее 20 бесплатных уроков по выбранной профессии, заполнить анкету, а также пройти интервью с наставником.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EСреди всех оставивших заявку и прошедших уроки разыграем еще 30 призов: полезные подписки, книги и мерч.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F79a\u002Fee8\u002F11d\u002F79aee811d3b1883b61032cc3a14949d7.png","eventUrl":"https:\u002F\u002Fspecial.hexlet.io\u002Fgrant?promo_name=freemium-grant%2520&promo_creative=habr&promo_start=050224","startDay":"2024-02-05","finishDay":"2024-02-29","isOnline":true,"geo":[]},{"id":"events_138","titleHtml":"Неделя победителей рейтинга Хабр Карьеры","descriptionHtml":"\u003Cp\u003EЭто неделя полезного контента и вакансий от компаний-победителей рейтинга Хабр Карьеры для тех, кто прямо сейчас ищет работу.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EВы познакомитесь с разными (но одинаково классными) компаниями — от известных гигантов до небольших звездочек. Всю неделю они будут честно рассказывать о том, как у них работается, и делиться горящими вакансиями.\u003C\u002Fp\u003E\u003Cp\u003EЧто еще вас ждет:\u003C\u002Fp\u003E\u003Cp\u003E→ публичное собеседование и разбор ваших резюме в прямом эфире вместе с опытным эйчаром;&nbsp;\u003C\u002Fp\u003E\u003Cp\u003E→ подборки полезных материалов от крутых спецов из компаний: что стоит почитать и посмотреть, чтобы оставаться в теме и качать скилы;\u003C\u002Fp\u003E\u003Cp\u003E→ Q&amp;A-сессия с эйчарами и другими специалистами в конце недели. Соберемся в специальном чате и закидаем их каверзными вопросами: узнаем про планы в найме, честно поговорим о деньгах и проектах, сохраним контакты друг друга на будущее;&nbsp;\u003C\u002Fp\u003E\u003Cp\u003E→ розыгрыш классного мерча от Хабр Карьеры.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EЧтобы принять участие в движухе, нужно просто перейти в тг-канал и следить за обновлениями. Стартуем 12 февраля!\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff53\u002Ff54\u002Fb2f\u002Ff53f54b2f7678f06644c36b44ff870cd.png","eventUrl":"https:\u002F\u002Ft.me\u002F+5yKQDGpksYM3NTYy","startDay":"2024-02-12","finishDay":"2024-02-18","isOnline":true,"geo":[]},{"id":"events_132","titleHtml":"Открытый урок «Тимлид с технической ролью и без неё»","descriptionHtml":"\u003Cp\u003EМожно ли стать тимлидом без технических навыков?\u003C\u002Fp\u003E\u003Cp\u003EРасскажет Дмитрий Смирягин, директор по управлению проектами, преподаватель курса «Team Lead» в OTUS, спикер крупных отраслевых конференций.\u003C\u002Fp\u003E\u003Cp\u003EВстречаемся на бесплатном открытом уроке, где мы:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eобсудим собирательные образы руководителей, их особенности и риски, связанные с этим;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eпоймём, обязательно ли Team Lead должен быть техническим экспертом в команде или это просто ценный бонус;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eвыявим свои сильные и слабые стороны;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eнаучимся выбирать оптимальную управленческую стратегию.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EЗанятие пройдёт 13 февраля в 20:00 мск и будет приурочено к старту курса «Team Lead». Продолжить обучение на курсе можно будет по специальной цене и даже в рассрочку.\u003C\u002Fp\u003E\u003Cp\u003EРегистрируйтесь сейчас, чтобы занять место на открытом уроке и получить запись.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F849\u002F5ba\u002F6c0\u002F8495ba6c0395a49ca999ba71073fa605.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_ool","startDay":"2024-02-13","startTime":"20:00","finishDay":"2024-02-13","isOnline":true,"geo":[]},{"id":"events_136","titleHtml":"Вебинар «Архитектура решений на основе Kubernetes»","descriptionHtml":"\u003Cp\u003EЦель бесплатного вебинара: изучить основные принципы архитектуры решений на основе Kubernetes, рассмотреть примеры реальных кейсов применения и поговорить о преимуществах данной технологии.\u003C\u002Fp\u003E\u003Cp\u003EПлан урока:\u003C\u002Fp\u003E\u003Cp\u003E1. Знакомство с Kubernetes.\u003C\u002Fp\u003E\u003Cp\u003E2. Преимущества использования Kubernetes.\u003C\u002Fp\u003E\u003Cp\u003E3. Архитектурные паттерны и примеры использования.\u003C\u002Fp\u003E\u003Cp\u003E4. Проектирование высокодоступных и масштабируемых систем на основе Kubernetes.\u003C\u002Fp\u003E\u003Cp\u003EУрок предназначен для DevOps-специалистов, разработчиков, системных администраторов и архитекторов, интересующихся применением Kubernetes для построения современных и надежных IT-инфраструктур.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4ab\u002Fbff\u002Ffd2\u002F4abbfffd208d3b4d5cd61c402d7ec3de.jpg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_oip","startDay":"2024-02-13","startTime":"20:00","finishDay":"2024-02-13","isOnline":true,"geo":[]},{"id":"events_144","titleHtml":"Открытый урок «Vault PKI. Строим собственный Certificate Authority»","descriptionHtml":"\u003Cp\u003EКак повысить надёжность и безопасность вашей инфраструктуры с помощью собственного Certificate Authority?\u003C\u002Fp\u003E\u003Cp\u003EУзнайте на бесплатном практическом уроке «Vault PKI. Строим собственный Certificate Authority (CA)» от OTUS.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EНа вебинаре разберём:\u003C\u002Fp\u003E\u003Cp\u003E1. Что такое Certificate Authority (CA). Познакомимся с Hashicorp Vault, узнаем, какой функционал он имеет и как его применять.\u003C\u002Fp\u003E\u003Cp\u003E2. Познакомимся с Vault PKI. Внедрим инфраструктуру открытых ключей и построим свой центр сертификации.\u003C\u002Fp\u003E\u003Cp\u003EЗанятие пройдёт 13 февраля в 20:00 и будет приурочено к старту курса «Administrator Linux. Professional». Доступна рассрочка на обучение.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6f0\u002F5ed\u002F6c3\u002F6f05ed6c3d7ec44efc35aa16efafc859.jpg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_olp","startDay":"2024-02-13","startTime":"20:00","finishDay":"2024-02-13","isOnline":true,"geo":[]},{"id":"events_146","titleHtml":"Открытый урок «Пишем музыкальный виджет на SwiftUI»","descriptionHtml":"\u003Cp\u003EХочешь написать музыкальный плеер для iOS?\u003C\u002Fp\u003E\u003Cp\u003EПриглашаем 15 февраля в 20:00 на бесплатный практический урок «Пишем музыкальный виджет на SwiftUI» от OTUS.\u003C\u002Fp\u003E\u003Cp\u003EВедущий — Анна Жаркова, руководитель группы разработки.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EНа вебинаре:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eсоздадим приложение с использованием музыкального сервиса MusicKit и интерактивный виджет к нему;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eпознакомимся со SwiftUI, узнаем, как создавать интерактивные виджеты с помощью WidgetKit и AppIntents;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eответим на все возникающие вопросы.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EВебинар является частью полноценного онлайн-курса «iOS Developer. Professional». Курс доступен в рассрочку.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Faa4\u002Fe0e\u002Ff99\u002Faa4e0ef990e286dc3cec513c7a7f2e58.jpg","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_oai","startDay":"2024-02-15","startTime":"20:00","finishDay":"2024-02-15","isOnline":true,"geo":[]},{"id":"events_158","titleHtml":"Практический урок «Почему не отслеживать метрики в IT-компании — плохая идея?»","descriptionHtml":"\u003Cp\u003EПочему в IT-компании необходимо отслеживать метрики?\u003C\u002Fp\u003E\u003Cp\u003EРасскажет Галина Баранова, преподаватель курса «COO\u002FОперационный директор в OTUS».&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EНа бесплатном практическом уроке вместе с экспертом рассмотрим:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eдля чего и какие нужны метрики и KPI;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eкакие нюансы нужно учесть при выборе и внедрении KPI;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eответы на ваши вопросы.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EПосле урока все участники получат чек-лист внедрения метрик и шаблон матрицы KPI.\u003C\u002Fp\u003E\u003Cp\u003EВстречаемся 15 февраля в 20:00 мск в рамках курса «COO\u002FОперационный директор в IT».\u003C\u002Fp\u003E\u003Cp\u003EРегистрируйтесь прямо сейчас, чтобы занять место на уроке и получить запись. После урока возможно продолжить обучение с рассрочкой платежа.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2ff\u002Fe12\u002F876\u002F2ffe128762377eae3980a5eab3e4f99d.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_otuskpi","startDay":"2024-02-15","startTime":"20:00","finishDay":"2024-02-15","isOnline":true,"geo":[]},{"id":"events_162","titleHtml":"One Day Offer от УЦСБ","descriptionHtml":"\u003Cp\u003EУЦСБ ищет специалистов по информационной безопасности и проводит One Day Offer.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EЭто специальное карьерное мероприятие, где за один день можно пройти путь соискателя: все этапы отбора, которые обычно занимают больше месяца, и получить предложение о работе в аккредитованной ИТ-компании.\u003C\u002Fp\u003E\u003Cp\u003EК участию приглашаются специалисты по Application Security, анализу защищенности (pentest), аналитики по информационной безопасности в направления аудита и разработки, инженеры автоматизации ИБ.\u003C\u002Fp\u003E\u003Cp\u003EВ&nbsp; рамках One Day Offer каждый участник пройдет собеседования с HR-специалистом и тимлидом команды разработки, выполнит тестовое задание, а также сможет неформально пообщаться с командой и познакомиться со своими потенциальными коллегами. В конце дня успешные кандидаты получат официальный оффер от УЦСБ.\u003C\u002Fp\u003E\u003Cp\u003EOne Day Offer пройдет в онлайн-формате, участвовать можно из любого уголка земли.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EДля участия необходимо иметь опыт работы в сфере ИБ от двух лет и оставить до 15 февраля заявку на участие на сайте. \u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6d4\u002F136\u002F22c\u002F6d413622ccff3c25ae26659f337e7dca.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_usscoffer","startDay":"2024-02-17","startTime":"10:00","finishDay":"2024-02-17","isOnline":true,"geo":[]},{"id":"events_142","titleHtml":"Первая всероссийская студенческая олимпиада по фронтенду","descriptionHtml":"\u003Cp\u003EЗапишись на первую всероссийскую студенческую олимпиаду по фронтенду. \u003C\u002Fp\u003E\u003Cp\u003EВсе задания —&nbsp;реальные задачи, с которыми фронтендеры сталкиваются каждый день. Никаких головоломок. Если умеете верстать и разбираетесь в JS —&nbsp;справитесь!\u003C\u002Fp\u003E\u003Cp\u003EПобедители олимпиады и лидеры рейтинга получат приглашение на работу или стажировку в Яндексе и других ведущих ИТ-компаниях России.\u003C\u002Fp\u003E\u003Cp\u003EОрганизаторы олимпиады\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EHTML Academy — крупнейшая российская онлайн-школа по веб-разработке, уже 12 лет готовит отличных разработчиков.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЯндекс — лидер на российском рынке инновационных высокотехнологичных продуктов. На олимпиаде валидирует задания и оценки.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EИТМО — ведущий вуз России в подготовке ИТ-специалистов, проверит задания и проведёт научное исследование результатов.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EКак подать заявку\u003C\u002Fp\u003E\u003Cp\u003EЗаходи на официальный сайт олимпиады и заполняй форму. Встречаемся онлайн, 18 февраля! Участие бесплатное.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd1e\u002Fa22\u002F4cd\u002Fd1ea224cd82ae67817b7cac7f7fc052c.png","eventUrl":"https:\u002F\u002Fhtmlacademy.ru\u002Folympics","startDay":"2024-02-18","finishDay":"2024-02-19","isOnline":true,"geo":[]},{"id":"events_156","titleHtml":"Практический урок «Hard Skills корпоративного архитектора»","descriptionHtml":"\u003Cp\u003EКакие hard skills нужны корпоративному архитектору в IT? \u003Cbr\u003E\u003Cbr\u003EРасскажет опытный эксперт на бесплатном практическом уроке от OTUS, где мы разберём:&nbsp;\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eценность корпоративного архитектора нового поколения;&nbsp;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eместо архитектора в компаниях различных типов;&nbsp;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eхарды, софты и чемоданчик архитектора;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eтиповой рабочий день архитектора.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EУрок идеально подойдёт опытным разработчикам, аналитикам, архитекторам и специалистам в предметных областях. \u003Cbr\u003E\u003Cbr\u003EВстречаемся 19 февраля в 19:00 (мск) в рамках курса «Enterprise Architect». После урока у вас будет возможность стать студентом курса по специальной цене и даже в рассрочку. \u003Cbr\u003E\u003Cbr\u003EЗарегистрируйтесь прямо сейчас, чтобы посетить бесплатный урок и получить запись.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fed3\u002F70c\u002F212\u002Fed370c212aac499c0289e66545c1c82e.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_otusea","startDay":"2024-02-19","startTime":"19:00","finishDay":"2024-02-19","isOnline":true,"geo":[]},{"id":"events_164","titleHtml":"Открытый урок «Stand Up \"Team Lead\". Открытый микрофон. 5 спикеров курса»","descriptionHtml":"\u003Cp\u003EИстории про «успешный успех» уже порядком надоели, поэтому давайте поговорим о провалах. На ошибках люди выносят для себя много важных выводов, уникальный опыт и стремятся быть лучше, не допуская промахов в будущем.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003E19 февраля в 20.00 (мск) приглашаем на открытый урок курса «Team Lead» в OTUS «Stand Up \"Team Lead\". Открытый микрофон. 5 спикеров курса», на котором преподаватели честно расскажут о своих косяках в процессе становления руководителями, а также:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eпоймём, как точно не надо делать;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eпоговорим о типичных ошибках и вынесенных уроках;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eобсудим, почему не нужно бояться конфликтов и увольнений.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EЭто открытый урок курса «Team Lead» с преподавателями-практиками и экспертами из ведущих отраслевых компаний. Партнёр курса – Avito.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EДля обучения возможны разные способы оплаты и рассрочка платежа.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc75\u002F441\u002F935\u002Fc7544193515536c86f9e6dce2908340b.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_otusstandup","startDay":"2024-02-19","startTime":"20:00","finishDay":"2024-02-19","isOnline":true,"geo":[]},{"id":"events_170","titleHtml":"Вебинар «Разрабатываем pipeline в ClearML и удаленный запуск на сервер»","descriptionHtml":"\u003Cp\u003EХотите свести «ручной труд» в MLOps к минимуму и автоматизировать однотипные задачи? Стройте пайплайны!&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EУдобное решение – фреймворк ClearML.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EOTUS приглашает 21.02.2024 в 20:00 мск на открытый практический вебинар «Разрабатываем pipeline в ClearML и удаленный запуск на сервер», который приурочен к старту онлайн курса «MLOps».&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EЗанятие проведёт Влад Пивоваров. Влад руководил исследованиями данных в Сбербанке, Airbnb, Groupon. На вебинаре:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EРазобьём сложный python-код на части.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EПревратим код в pipeline.&nbsp;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЗапустим обучение на удалённой машине.&nbsp;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EПри регистрации можно пройти короткий вступительный тест на знание ML.\u003C\u002Fp\u003E\u003Cp\u003EВебинар будет интересен дата-сайентистам, MLOps- и devops-инженерам.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EПосле вебинара вы сможете записаться на курс «MLOps». Обучение доступно в рассрочку.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9b\u002F40b\u002Fbbb\u002Fa9b40bbbbd5a1f307dcc513f764bbecc.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_otuswebML","startDay":"2024-02-21","startTime":"20:00","finishDay":"2024-02-21","isOnline":true,"geo":[]},{"id":"events_122","titleHtml":"Вебинар «Лихие джуновские: что нужно знать про найм в ML\u002FDS в начале карьеры»","descriptionHtml":"\u003Cp\u003EЧто нужно знать про найм в ML\u002FDS в начале карьеры?\u003C\u002Fp\u003E\u003Cp\u003EНа вебинаре Борис Цейтлин расскажет про поиск работы в ML\u002FDS в России и не только.\u003C\u002Fp\u003E\u003Cp\u003EВы узнаете:\u003C\u002Fp\u003E\u003Col\u003E\u003Cli\u003E\u003Cp\u003EКакие пет-проекты делать для портфолио.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКак искать вакансии и откликаться на них.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКак проходить собеседования.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EКак стать священной коровой для компании.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EЧему учиться.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Fol\u003E\u003Cp\u003EВстречаемся 27 февраля в 20:00 по Москве в рамках курса Machine Learning Professional.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd6e\u002F1b0\u002F4c8\u002Fd6e1b04c878148e37a547e03a37c18ee.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_otus_mlds","startDay":"2024-02-27","startTime":"20:00","isOnline":true,"geo":[]},{"id":"events_140","titleHtml":"DevOpsConf 2024: конференция для инженеров и всех, кто должен понимать инженеров","descriptionHtml":"\u003Cp\u003E4 и 5 марта состоится DevOpsConf 2024 в Москве.\u003C\u002Fp\u003E\u003Cp\u003EМы готовим самую крупную конференцию для инженеров, CTO, CIO, техлидов и тимлидов в России и СНГ. Более 1000 ваших единомышленников соберутся в Сколково в самом начале весны.\u003C\u002Fp\u003E\u003Cp\u003EC 2009 года конференция значительно выросла, в программе 15-й DevOpsConf: более 80 докладов от ведущих экспертов, 10+ воркшопов, митапы и круглые столы.\u003C\u002Fp\u003E\u003Cp\u003EТемы этого года:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eуправление в DevOps;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Ereliability engineering;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eplatform engineering глазами инженеров из СберМаркет и Яндекс.Go;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eсистемное администрирование;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EIT-безопасность и DevSecOps;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eэксплуатация крупных проектов;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eтехнологическая независимость;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eновые инструменты и технологии.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EВстречаемся 4 и 5 марта на DevOpsConf 2024 в Сколково.\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2a5\u002Fb6d\u002F6fc\u002F2a5b6d6fc13caf3dabce9c8ab833e282.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_odc","startDay":"2024-03-04","startTime":"10:00","finishDay":"2024-03-05","finishTime":"20:00","isOnline":true,"geo":["Москва"]},{"id":"events_160","titleHtml":"«GoCloud 2024. Облачные грани будущего» — IT-конференция Cloud.ru про облака","descriptionHtml":"\u003Cp\u003EВместе обсудим IT-тренды, поделимся опытом и найдем инновационные решения для ваших задач.&nbsp;\u003C\u002Fp\u003E\u003Cp\u003EЧто ждет участников:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E3 тематических трека про новую облачную платформу, прорывные технологии и клиентские инсайты;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E20 сессий с экспертами из мира облачных технологий;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Elive-демонстрации облачных платформ и сервисов;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eнетворкинг с разработчиками и идеологами продуктов Cloud.ru.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EКлючевые темы GoCloud 2024:\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003Eоблако и бизнес: кейсы российских компаний вместе с Cloud.ru;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eopen source: последние разработки;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003ESDS, SDN и Serverless;\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Eобзор новой облачной платформы Cloud.ru.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EКому будет полезно: техническим специалистам, лидерам команд разработки и администрирования, руководителям технологических направлений и R&amp;D, экспертам и лидерам мнений в IT-индустрии.\u003C\u002Fp\u003E\u003Cp\u003EМероприятие пройдёт в Цифровом деловом пространстве по адресу: ул. Покровка, 47, Москва.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9e2\u002F1fc\u002Ff5c\u002F9e21fcf5cb7e9bae5b0f7cb2fafd6a99.png","eventUrl":"https:\u002F\u002Fu.habr.com\u002Fcldr_gocloudcon","startDay":"2024-03-21","startTime":"09:00","finishDay":"2024-03-21","finishTime":"18:00","isOnline":true,"geo":["Москва"]}]},"wysiwyg":{"WYSIWYGRulesRefs":null}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script>
<script src="https://assets.habr.com/habr-web/js/chunk-vendors.13e568be.js" defer></script><script src="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" defer></script><script src="https://assets.habr.com/habr-web/js/app.757efe33.js" defer></script>



    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S28W1WC23F"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script>
  
  <script type="text/javascript" >
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script>
  <noscript>
    <div>
      <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt="" />
    </div>
  </noscript>
  
    <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script>
  
<script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>
</body>
</html>
